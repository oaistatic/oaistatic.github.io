"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2422],{82422:function(e,t,i){i.r(t),i.d(t,{__N_SSP:function(){return il},default:function(){return io}});var a,s,r,n,l,o,c,d,u,p,m=i(89691),h=i(39827),g=i(25660),f=i(88128),x=i(73017),v=i(33925),j=i(16244),y=i(49508),b=i(5572),w=i(10518),k=i(91530),N=i.n(k),z=i(70079),P=i(21389),_=i(35250);let M=P.Z.a(o||(o=(0,x.Z)(["bold underline"]))),Z=P.Z.textarea(c||(c=(0,x.Z)(["w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32"]))),T=((a={})[a.None=0]="None",a[a.AppealAvailable=1]="AppealAvailable",a[a.AppealSent=2]="AppealSent",a),C=((s={})[s.None=0]="None",s[s.PublishBlocked=1]="PublishBlocked",s[s.RemovedFromMarketplace=2]="RemovedFromMarketplace",s[s.RemovedFromPublic=3]="RemovedFromPublic",s[s.RemovedFromPrivate=4]="RemovedFromPrivate",s[s.Recategorized=5]="Recategorized",s);var O=((r=O||{})[r.Initial=0]="Initial",r[r.AppealForm=1]="AppealForm",r[r.SubmittedConfirmation=2]="SubmittedConfirmation",r);function S(e){let{gizmoId:t,sharingRecipient:i,categories:a,moderationType:s,sharingTargets:r,appealAvailable:n,onClose:l,onAppealSubmitted:o}=e,{0:c,1:d}=(0,z.useState)(""),{0:u,1:p}=(0,z.useState)(O.Initial),m=async()=>{await y.U.postGizmoAppeal(t,c,i,a),p(O.SubmittedConfirmation),null==o||o()};switch(u){case O.Initial:return(0,_.jsx)(j.Z,{title:function(e){switch(e){case C.PublishBlocked:return"Your changes couldn’t be published";case C.RemovedFromMarketplace:return"Your GPT has been removed from the marketplace";case C.RemovedFromPublic:return"Your GPT has been removed from public view";case C.Recategorized:return"Your GPT has been recategorized"}}(s),isOpen:!0,onClose:l,showCloseButton:!0,primaryButton:(0,_.jsx)(v.ZP.Button,{title:"Continue",color:"primary",onClick:l}),secondaryButton:n?(0,_.jsx)(v.ZP.Button,{title:"Appeal",onClick:()=>p(O.AppealForm)}):void 0,type:"warning",children:(0,_.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:function(e,t,i){var a;let s=null==t?void 0:t.find(t=>t.recipient===e),r=null==s?void 0:s.moderated_fields,n=null!==(a=null==r?void 0:r.length)&&void 0!==a?a:0;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("p",{children:[function(e){switch(e){case b.Zz.Private:case b.Zz.Workspace:return(0,_.jsxs)(_.Fragment,{children:["Your GPT can’t be updated because it violates our"," ",(0,_.jsx)(M,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:"Usage Policies"}),"."]});case b.Zz.Link:return(0,_.jsxs)(_.Fragment,{children:["Your GPT can’t be shared publicly because it violates our"," ",(0,_.jsx)(M,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:"Usage Policies"}),"."]});case b.Zz.Marketplace:return(0,_.jsxs)(_.Fragment,{children:["Your GPT can’t appear in the Explore GPTs page because it violates our"," ",(0,_.jsx)(M,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:"Usage Policies"}),"."]})}}(e)," ",n>1?"See below for the specific issues:":1==n?"See below for the specific issue:":""]}),n>0&&(null==r?void 0:r.map(e=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("p",{className:"font-bold",children:function(e){switch(e){case"profile_picture":return"Profile Picture";case"gizmo_name":return"Name";case"gizmo_description":return"Description";case"gizmo_instructions":return"Instructions";case"gizmo_welcome_message":return"Welcome Message";case"custom_actions":return"Custom Actions";case"conversation_starter":return"Conversation Starter";case"file":return"File";default:return}}(e.name)}),(0,_.jsx)("ul",{className:"list-disc pl-5",children:e.reasons.map(e=>(0,_.jsxs)("li",{children:[e.description," ",e.link?(0,_.jsx)(M,{href:e.link,target:"_blank",rel:"noreferrer",children:"Learn more"}):""]},e.description))})]}))),i&&(0,_.jsx)("p",{children:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})]})}(i,r,n)})});case O.AppealForm:return(0,_.jsx)(j.Z,{title:"Appeal",isOpen:!0,onClose:l,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:(0,_.jsx)(v.ZP.Button,{title:"Submit",color:"primary",onClick:m,disabled:0===c.trim().length}),secondaryButton:(0,_.jsx)(v.ZP.Button,{title:"Back",onClick:()=>p(O.Initial)}),type:"warning",children:(0,_.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,_.jsx)("p",{children:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"}),(0,_.jsx)(Z,{value:c,onChange:e=>d(e.target.value)})]})});case O.SubmittedConfirmation:return(0,_.jsx)(_.Fragment,{})}}function A(e){let{onClose:t}=e;return(0,_.jsx)(j.Z,{title:"Appeal submitted",isOpen:!0,onClose:t,showCloseButton:!0,primaryButton:(0,_.jsx)(v.ZP.Button,{title:"Close",color:"primary",onClick:t}),type:"success",children:(0,_.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:(0,_.jsx)("div",{children:"Your appeal has been submitted. We will get back to you as soon as possible."})})})}function I(e){let{gizmoId:t,onClose:i}=e,{data:a}=(0,m.b9)(t,!0),s=async()=>{await y.U.postGizmoCancelAppeal(t)};return(0,_.jsx)(j.Z,{isOpen:!0,onClose:N(),primaryButton:(0,_.jsx)(v.ZP.Button,{title:"Cancel appeal",color:"primary",onClick:()=>{s(),null==i||i()}}),type:"warning",children:(0,_.jsxs)("div",{className:"flex flex-col gap-2 text-sm",children:[(0,_.jsx)("h2",{className:"text-lg font-semibold",children:"Reviewing your appeal"}),(0,_.jsxs)("p",{children:["During the review you can continue using “",null==a?void 0:a.gizmo.display.name,"” as your private GPT, but won’t be able to update it or share it with others."]})]})})}function E(e){let{appealState:t,onAppealClose:i,onAppealSubmitted:a}=e,{value:s}=(0,w.sB)(w.tz.GizmoAppeals),{0:r,1:n}=(0,z.useState)(!1);return r?(0,_.jsx)(A,{onClose:()=>{n(!1),null==a||a()}}):(0,_.jsxs)(_.Fragment,{children:[(null==t?void 0:t.showModal)==T.AppealSent&&(0,_.jsx)(I,{gizmoId:t.gizmoId,onClose:i}),(null==t?void 0:t.showModal)==T.AppealAvailable&&(0,_.jsx)(S,{gizmoId:t.gizmoId,sharingRecipient:t.sharingRecipient,categories:t.categories,moderationType:t.moderationType,sharingTargets:t.sharingTargets,appealAvailable:s,onClose:()=>null==i?void 0:i(),onAppealSubmitted:()=>n(!0)})]})}var G=i(42005),L=i(65455),U=i(24668),R=i(9417),D=i(99784),V=i(78e3),B=i(30640),F=i(84126),q=i(39496),W=i(51533),J=i(28354),Y=i(53197),H=i(39352),K=i(92442),Q=i(19841),X=i(61888),$=i(12366),ee=i.n($),et=i(9063),ei=i(99424),ea=i(22433),es=i(7557),er=i(8402),en=i(84692),el=i(68498),eo=i(1703),ec=i(36607),ed=i(66218);function eu(e){let{onSelectExample:t}=e,i=(0,et.Z)(),a=(0,z.useRef)(null);return(0,_.jsxs)("select",{onChange:e=>{"label"!==e.target.value&&(t(em[parseInt(e.target.value)].spec),a.current.value="label")},className:"h-8 rounded-lg border border-token-border-medium bg-transparent px-2 py-0 text-sm",ref:a,children:[(0,_.jsx)("option",{value:"label",children:i.formatMessage(ep.examples)}),em.map((e,t)=>(0,_.jsx)("option",{value:t,children:i.formatMessage(e.displayName)},t))]})}let ep=(0,el.vU)({examples:{id:"gizmo.actions.examples",defaultMessage:"Examples"},weatherExampleTitle:{id:"gizmo.actions.weatherExampleTitle",defaultMessage:"Weather (JSON)"},petStoreExampleTitle:{id:"gizmo.actions.petStoreExampleTitle",defaultMessage:"Pet Store (YAML)"},blankExampleTitle:{id:"gizmo.actions.blankExampleTitle",defaultMessage:"Blank Template"}}),em=[{displayName:ep.weatherExampleTitle,spec:JSON.stringify({openapi:"3.1.0",info:{title:"Get weather data",description:"Retrieves current weather data for a location.",version:"v1.0.0"},servers:[{url:"https://weather.example.com"}],paths:{"/location":{get:{description:"Get temperature for a specific location",operationId:"GetCurrentWeather",parameters:[{name:"location",in:"query",description:"The city and state to retrieve the weather for",required:!0,schema:{type:"string"}}],deprecated:!1}}},components:{schemas:{}}},null,2)},{displayName:ep.petStoreExampleTitle,spec:'# Taken from https://github.com/OAI/OpenAPI-Specification/blob/main/examples/v3.0/petstore.yaml\n\nopenapi: "3.0.0"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: https://petstore.swagger.io/v1\npaths:\n  /pets:\n    get:\n      summary: List all pets\n      operationId: listPets\n      tags:\n        - pets\n      parameters:\n        - name: limit\n          in: query\n          description: How many items to return at one time (max 100)\n          required: false\n          schema:\n            type: integer\n            maximum: 100\n            format: int32\n      responses:\n        \'200\':\n          description: A paged array of pets\n          headers:\n            x-next:\n              description: A link to the next page of responses\n              schema:\n                type: string\n          content:\n            application/json:    \n              schema:\n                $ref: "#/components/schemas/Pets"\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\n    post:\n      summary: Create a pet\n      operationId: createPets\n      tags:\n        - pets\n      responses:\n        \'201\':\n          description: Null response\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\n  /pets/{petId}:\n    get:\n      summary: Info for a specific pet\n      operationId: showPetById\n      tags:\n        - pets\n      parameters:\n        - name: petId\n          in: path\n          required: true\n          description: The id of the pet to retrieve\n          schema:\n            type: string\n      responses:\n        \'200\':\n          description: Expected response to a valid request\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Pet"\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: "#/components/schemas/Error"\ncomponents:\n  schemas:\n    Pet:\n      type: object\n      required:\n        - id\n        - name\n      properties:\n        id:\n          type: integer\n          format: int64\n        name:\n          type: string\n        tag:\n          type: string\n    Pets:\n      type: array\n      maxItems: 100\n      items:\n        $ref: "#/components/schemas/Pet"\n    Error:\n      type: object\n      required:\n        - code\n        - message\n      properties:\n        code:\n          type: integer\n          format: int32\n        message:\n          type: string'},{displayName:ep.blankExampleTitle,spec:JSON.stringify({openapi:"3.1.0",info:{title:"Untitled",description:"Your OpenAPI specification",version:"v1.0.0"},servers:[{url:""}],paths:{},components:{schemas:{}}},null,2)}];var eh=i(25991),eg=i(47155),ef=i(23340);function ex(e){let{clientThreadId:t}=e,i=(0,D.oq)(t),a=(0,ef.Bv)(t),s=(0,D.U0)(t,i),r=[...Array(s).keys()].map(e=>(0,_.jsx)(eg.Z,{isFinalTurn:e===s-1,turnIndex:e,clientThreadId:t,conversationLeafId:i,onChangeItemInView:X.noop,onChangeRating:X.noop,onRequestMoreCompletions:X.noop,onRequestCompletion:X.noop,currentModelId:null!=a?a:""},e));return(0,_.jsx)(_.Fragment,{children:r})}function ev(e){let{clientThreadIds:t}=e;return(0,_.jsx)(_.Fragment,{children:t.map(e=>(0,_.jsx)(ex,{clientThreadId:e},e))})}var ej=i(36932),ey=i(50484),eb=i(61161),ew=i(78623),ek=i(18405),eN=i(4579),ez=i(8869),eP=i(45534),e_=i(58849),eM=i(91225),eZ=i(83737),eT=i(1454),eC=i(8844),eO=i(3243),eS=i(37345),eA=i(22824);function eI(){return(0,_.jsxs)("div",{className:"flex items-center",children:[(0,_.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"}),(0,_.jsxs)("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[(0,_.jsx)(eT.V7f,{}),"GPT updated"]}),(0,_.jsx)("div",{className:"border-token-border-secondary flex-grow border-b"})]})}let eE=((n={}).TestGizmoAction="test_gizmo_action",n),eG=new ez.V,eL=z.memo(function(e){var t;let{gizmoEditorData:i,isSavingDraft:a,showTitle:s=!0}=e,{0:r,1:n}=(0,z.useState)(()=>(0,D.OX)()),{0:l,1:o}=(0,z.useState)([]);(0,z.useEffect)(()=>{o(e=>e[e.length-1]===r?e:[...e,r])},[r]);let c=l.slice(0,-1);(0,D.ax)(r,{kind:ea.OL.GizmoTest,gizmo_id:i.id}),(0,z.useEffect)(()=>{D.tQ.updateConversationMode(r,{kind:ea.OL.GizmoTest,gizmo_id:i.id})},[r,i.id]);let d=(0,D.UL)(r),u=null===(t=i.files)||void 0===t?void 0:t.map(e=>e.file_id).join();(0,z.useEffect)(()=>{null!=D.tQ.getServerThreadId(r)&&n((0,D.OX)())},[i.id,i.instructions,i.tools,u,r]),(0,z.useEffect)(()=>{(0,D.Zz)(r)&&D.iN.hasThread(r)&&d.lastModelUsed!==ef.mx&&D.tQ.updateInitialThreadDataForNewThread(r,ef.mx,[])},[r,d,i]);let p=(0,ek.tN)(e=>e.activeSidebar),m=(0,z.useMemo)(()=>({gizmoEditorData:i,mode:"test"}),[i]),{0:h,1:g}=(0,z.useState)(0),f=()=>{g(e=>e-360)},x=i.id,v=function(e){let t=(0,eO.Z)(e,void 0,X.noop,[]);return(0,z.useCallback)(async(i,a,s)=>{let r=D.tQ.getThreadCurrentLeafId(e),n=(0,eC.Z)();D.tQ.updateTree(e,e=>{e.addNodeToEnd(r,{id:n,children:[],parentId:r,message:{id:n,author:{role:ea.uU.User},content:{content_type:ea.PX.Text,parts:["Call the ".concat(a," API with the ").concat(s," operation")]},recipient:"all",metadata:{jit_plugin_data:{from_client:{type:"test",operation:s,tool_name:(0,eb.VN)(a)}}}}})});let l={conversationMode:{kind:ea.OL.GizmoTest,gizmo_id:i}},o=await (0,e_.rS)(ea.OL.GizmoTest),c=await eP.ZP.getEnforcementToken(o),d=await eM.Z.getEnforcementToken(o);t({model:ef.mx,completionType:ea.Os.Next,parentNodeId:n,metadata:{},focusOnNewCompletion:!0,arkoseToken:c,turnstileToken:d,preflightTime:0,completionMetadata:l})},[e,t])}(r);return(0,z.useEffect)(()=>(0,eN.LW)(eG,{test_gizmo_action:e=>{let{rootDomain:t,operationName:i}=e;x&&v(x,t,i)}}),[v,x]),(0,_.jsx)(eS.D.Provider,{value:m,children:(0,_.jsxs)("div",{className:(0,Q.default)("flex h-full w-full",a&&"cursor-wait opacity-80 transition"),children:[(0,_.jsxs)("div",{className:"flex grow flex-col",children:[(0,_.jsx)("div",{className:"relative mb-2 flex-shrink-0",children:(0,_.jsx)("div",{className:"flex justify-center py-1",children:s&&(0,_.jsxs)("div",{className:"group flex items-center gap-2 text-lg font-medium",children:[(0,_.jsx)("div",{className:"icon-md"}),(0,_.jsxs)("button",{onClick:()=>{f(),o([]),n((0,D.OX)())},className:"flex items-center gap-2",children:["Preview",(0,_.jsx)(eZ.E.div,{className:"text-token-text-primary",animate:{rotate:h},transition:{duration:.3},children:(0,_.jsx)(er.u8,{className:"icon-md invisible group-hover:visible"})})]})]})})}),(0,_.jsx)("div",{className:(0,Q.default)("relative grow overflow-auto px-2",a&&"pointer-events-none"),children:(0,_.jsx)(ej.Z,{clientThreadId:r,hideHeader:!0,renderEmptyState:(0,_.jsxs)("div",{className:"relative h-full w-full",children:[null!=c&&c.length>0&&(0,_.jsx)("div",{className:"h-full w-full opacity-20",children:(0,_.jsxs)(ey.I,{children:[(0,_.jsx)(ev,{clientThreadIds:c}),(0,_.jsx)(eI,{})]})}),(0,_.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,_.jsx)(eA.r,{gizmo:i,isOwner:!0,hideOwner:!0})})]}),prependThreadChildren:c.length>0&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"opacity-50",children:(0,_.jsx)(ev,{clientThreadIds:c})}),(0,_.jsx)(eI,{})]})})})]}),"debug"===p&&(0,_.jsx)(ew.fv,{clientThreadId:r,slideOver:!1,onClose:()=>ek.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})});var eU=i(28373);function eR(e){let{content:t,button:i,onClick:a}=e;return(0,_.jsxs)("div",{className:"flex rounded-lg border border-token-border-medium text-sm hover:cursor-pointer",onClick:a,children:[(0,_.jsx)("div",{className:"h-9 grow px-3 py-2",children:t}),(0,_.jsx)("div",{className:"w-px bg-token-border-medium"}),i]})}let eD=["oauth_client_id","oauth_client_secret"],eV=["api_key"];function eB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function eF(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?eB(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):eB(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let eq="".concat("https://chat.openai.com","/g/g-TYEliDU6A-actionsgpt");function eW(e){let{children:t}=e;return(0,_.jsx)("label",{className:"mb-1 block text-sm font-medium",children:t})}function eJ(e){var t,i,a,s,r,n,l,o,c,d,u,p,m,h;let{jitPluginTool:g,onUpdateTool:f,onClose:x}=e,v=(0,et.Z)(),{0:y,1:b}=(0,z.useState)({apiKeyValue:"",oauthClientIdValue:"",oauthClientSecretValue:"",oauthAuthUrlValue:null!==(t=null==g||null===(i=g.metadata)||void 0===i||null===(i=i.auth)||void 0===i?void 0:i.client_url)&&void 0!==t?t:"",oauthTokenUrlValue:null!==(a=null==g||null===(s=g.metadata)||void 0===s||null===(s=s.auth)||void 0===s?void 0:s.authorization_url)&&void 0!==a?a:"",oauthScopeValue:null!==(r=null==g||null===(n=g.metadata)||void 0===n||null===(n=n.auth)||void 0===n?void 0:n.scope)&&void 0!==r?r:"",authTypeValue:null!==(l=null==g||null===(o=g.metadata)||void 0===o||null===(o=o.auth)||void 0===o?void 0:o.type)&&void 0!==l?l:ea.Jv.None,httpAuthTypeValue:null!==(c=null==g||null===(d=g.metadata)||void 0===d||null===(d=d.auth)||void 0===d?void 0:d.authorization_type)&&void 0!==c?c:"basic",customHeaderValue:null!==(u=null==g||null===(p=g.metadata)||void 0===p||null===(p=p.auth)||void 0===p?void 0:p.custom_auth_header)&&void 0!==u?u:"",tokenExchangeMethodValue:null!==(m=null==g||null===(h=g.metadata)||void 0===h||null===(h=h.auth)||void 0===h?void 0:h.token_exchange_method)&&void 0!==m?m:"default_post"});function w(e){b(t=>eF(eF({},t),e))}return(0,_.jsxs)(j.Z,{type:"success",isOpen:!0,title:v.formatMessage({id:"kZ040s",defaultMessage:"Authentication"}),primaryButton:(0,_.jsx)(es.z,{color:"dark",onClick:()=>{f(y.authTypeValue===ea.Jv.None?{type:ea.Jv.None}:y.authTypeValue===ea.Jv.OAuth?{type:ea.Jv.OAuth,client_url:y.oauthAuthUrlValue,authorization_url:y.oauthTokenUrlValue,authorization_content_type:"application/x-www-form-urlencoded",scope:y.oauthScopeValue,token_exchange_method:y.tokenExchangeMethodValue,oauth_client_id:y.oauthClientIdValue,oauth_client_secret:y.oauthClientSecretValue}:{type:ea.Jv.ServiceHTTP,authorization_type:y.httpAuthTypeValue,custom_auth_header:y.customHeaderValue,api_key:y.apiKeyValue}),x()},children:(0,_.jsx)(en.Z,{id:"dchvRM",defaultMessage:"Save"})}),secondaryButton:(0,_.jsx)(es.z,{color:"neutral",onClick:x,children:(0,_.jsx)(en.Z,{id:"xHBR5t",defaultMessage:"Cancel"})}),onClose:x,children:[(0,_.jsxs)("div",{className:"mb-4",children:[(0,_.jsx)(en.Z,{id:"la7zPT",defaultMessage:"Authentication Type"}),(0,_.jsxs)(ed.Z.Root,{onValueChange:e=>{w({authTypeValue:e})},value:y.authTypeValue,className:"flex gap-4",children:[(0,_.jsx)(eU.Xb,{label:v.formatMessage({id:"Ml5rNZ",defaultMessage:"None"}),value:ea.Jv.None}),(0,_.jsx)(eU.Xb,{label:v.formatMessage({id:"rN0uCi",defaultMessage:"API Key"}),value:ea.Jv.ServiceHTTP}),(0,_.jsx)(eU.Xb,{label:v.formatMessage({id:"qG7Z4O",defaultMessage:"OAuth"}),value:ea.Jv.OAuth})]})]}),"service_http"===y.authTypeValue?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"hSd+5k",defaultMessage:"API Key"})}),(0,_.jsx)(eh.yt,{placeholder:v.formatMessage({id:"9W9lGr",defaultMessage:"[HIDDEN]"}),type:"password",value:y.apiKeyValue,onChange:e=>{w({apiKeyValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"PSnRGf",defaultMessage:"Auth Type"})}),(0,_.jsxs)(ed.Z.Root,{className:"mb-2 flex gap-6 overflow-hidden rounded-lg",value:y.httpAuthTypeValue,required:!0,onValueChange:e=>{w({httpAuthTypeValue:e})},children:[(0,_.jsx)(eU.Xb,{value:"basic",label:"Basic"}),(0,_.jsx)(eU.Xb,{value:"bearer",label:"Bearer"}),(0,_.jsx)(eU.Xb,{value:"custom",label:v.formatMessage({id:"6kqx38",defaultMessage:"Custom"})})]}),"custom"===y.httpAuthTypeValue&&(0,_.jsxs)("div",{className:"mt-2",children:[(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"XqdT/P",defaultMessage:"Custom Header Name"})}),(0,_.jsx)(eh.yt,{value:y.customHeaderValue,onChange:e=>{w({customHeaderValue:e.target.value})},className:"mb-2",placeholder:"X-Api-Key"})]})]}):"oauth"===y.authTypeValue?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"lS4nvz",defaultMessage:"Client ID"})}),(0,_.jsx)(eh.yt,{placeholder:"<HIDDEN>",type:"password",value:y.oauthClientIdValue,onChange:e=>{w({oauthClientIdValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"OvwGR3",defaultMessage:"Client Secret"})}),(0,_.jsx)(eh.yt,{placeholder:"<HIDDEN>",type:"password",value:y.oauthClientSecretValue,onChange:e=>{w({oauthClientSecretValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"I27qZU",defaultMessage:"Authorization URL"})}),(0,_.jsx)(eh.yt,{value:y.oauthAuthUrlValue,onChange:e=>{w({oauthAuthUrlValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"QywIpF",defaultMessage:"Token URL"})}),(0,_.jsx)(eh.yt,{value:y.oauthTokenUrlValue,onChange:e=>{w({oauthTokenUrlValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"1VAJqN",defaultMessage:"Scope"})}),(0,_.jsx)(eh.yt,{value:y.oauthScopeValue,onChange:e=>{w({oauthScopeValue:e.target.value})},className:"mb-2"}),(0,_.jsx)(eW,{children:(0,_.jsx)(en.Z,{id:"9MvwPc",defaultMessage:"Token Exchange Method"})}),(0,_.jsxs)(ed.Z.Root,{value:y.tokenExchangeMethodValue,required:!0,onValueChange:e=>{w({tokenExchangeMethodValue:e})},children:[(0,_.jsx)(eU.Xb,{value:"default_post",label:v.formatMessage({id:"vXIzoE",defaultMessage:"Default (POST request)"})}),(0,_.jsx)(eU.Xb,{value:"basic_auth_header",label:v.formatMessage({id:"38o+yX",defaultMessage:"Basic authorization header"})})]})]}):null]})}function eY(e){let{onImport:t,onClose:i}=e,{0:a,1:s}=(0,z.useState)(""),{0:r,1:n}=(0,z.useState)(!1);async function l(){var e;let s;try{s=new URL(a)}catch{return}if(null!==(e=s)&&void 0!==e&&e.hostname){n(!0);try{let e=await y.U.fetchOpenAPISpec(a);t(e.content),i()}finally{n(!1)}}}return(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[(0,_.jsx)("input",{name:"url",value:a,onChange:e=>{s(e.target.value)},placeholder:"https://...",className:"h-8 rounded border border-token-border-light px-2 text-sm",autoFocus:!0}),(0,_.jsx)(eU.cY,{color:"dark",loading:r,onClick:l,children:(0,_.jsx)(en.Z,{id:"7sLuEB",defaultMessage:"Import"})}),(0,_.jsx)(eU.cY,{color:"neutral",onClick:i,children:(0,_.jsx)(en.Z,{id:"xHBR5t",defaultMessage:"Cancel"})})]})}function eH(e){let{rootDomain:t,operations:i}=e;return null==i||0===i.length?(0,_.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,_.jsx)(en.Z,{id:"L69u6d",defaultMessage:"Operations in your schema will show here"})}):(0,_.jsx)("table",{className:"w-full text-sm",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{className:"border-b border-token-border-light text-left text-xs text-token-text-tertiary",children:[(0,_.jsx)("th",{className:"py-1 font-normal",children:(0,_.jsx)(en.Z,{id:"JizDcr",defaultMessage:"Name"})}),(0,_.jsx)("th",{className:"py-1 font-normal",children:(0,_.jsx)(en.Z,{id:"zN16fd",defaultMessage:"Method"})}),(0,_.jsx)("th",{className:"py-1 font-normal",children:(0,_.jsx)(en.Z,{id:"y2WJvt",defaultMessage:"Path"})}),(0,_.jsx)("th",{className:"py-1 font-normal"})]}),i.map(e=>(0,_.jsxs)("tr",{className:"border-b border-token-border-light",children:[(0,_.jsx)("td",{className:"py-2",children:e.operationName}),(0,_.jsx)("td",{className:"py-2 uppercase",children:e.method}),(0,_.jsx)("td",{className:"py-2",children:e.path}),(0,_.jsx)("td",{className:"py-2",children:(0,_.jsx)(eU.cY,{color:"neutral",onClick:()=>{t&&eG.publish({kind:eE.TestGizmoAction,rootDomain:t,operationName:e.operationName})},children:(0,_.jsx)(en.Z,{id:"Ag71GQ",defaultMessage:"Test"})})})]},e.operationName))]})})}function eK(e){let{validationResponse:t}=e,i=(0,et.Z)();return(0,_.jsxs)("div",{children:[(0,_.jsx)(eh.lX,{label:i.formatMessage({id:"hKfo5R",defaultMessage:"Available actions"})}),(0,_.jsx)(eH,{rootDomain:t.success?t.spec.root_domain:void 0,operations:t.success?t.spec.operations:void 0})]})}function eQ(e){var t,i,a,s,r,n,l;let{currentlyEditingActionDomain:o,gizmoEditorData:c,updateGizmo:d,onClose:u}=e,p=(0,et.Z)(),{0:m,1:h}=(0,z.useState)(o),f=(0,z.useRef)(m);(0,z.useEffect)(()=>{f.current=m},[m]);let x=null==c||null===(t=c.tools)||void 0===t?void 0:t.find(e=>e.type===g.qK.JIT_PLUGIN&&e.metadata.domain===m),{0:v}=(0,z.useState)(()=>null==x),j=null!==(i=null==x||null===(a=x.metadata)||void 0===a?void 0:a.raw_spec)&&void 0!==i?i:"",{0:b,1:w}=(0,z.useState)(!1),{0:k,1:N}=(0,z.useState)(!1);function P(e){d(t=>eF(eF({},t),{},{tools:x?t.tools.map(t=>t.type===g.qK.JIT_PLUGIN&&t.metadata.domain===m?eF(eF({},t),{},{metadata:eF(eF(eF({},t.metadata),e),{},{json_schema:void 0})}):t):[...t.tools,{type:g.qK.JIT_PLUGIN,metadata:eF(eF({raw_spec:"",domain:null!=m?m:"Unknown domain",action_id:""},e),{},{json_schema:void 0})}]}))}let{0:M,1:Z}=(0,z.useState)(),{0:T}=(0,z.useState)(()=>(0,X.debounce)(async function(e){let t=await y.U.validateOpenAPISpec(e);Z(t);let i=t.success?t.spec.root_domain:void 0;if(i){if(i!==f.current){var a;if(null==c||null===(a=c.tools)||void 0===a?void 0:a.find(e=>e.type===g.qK.JIT_PLUGIN&&e.metadata.domain===i)){Z({success:!1,errors:[p.formatMessage({id:"nwBcmJ",defaultMessage:"Action sets cannot have duplicate domains - {domain} already exists on another action"},{domain:i})]});return}}d(e=>eF(eF({},e),{},{tools:e.tools.map(e=>e.type===g.qK.JIT_PLUGIN&&e.metadata.domain===f.current?eF(eF({},e),{},{metadata:eF(eF({},e.metadata),{},{domain:i})}):e)})),h(i)}if(t.success&&t.known_auth&&t.known_privacy_policy&&x){let e=eF({type:ea.Jv.OAuth},t.known_auth);(0,X.isEqual)(x.metadata.auth,e)||P({auth:eF({type:ea.Jv.OAuth},t.known_auth)}),x.metadata.privacy_policy_url!==t.known_privacy_policy&&P({privacy_policy_url:t.known_privacy_policy})}},1e3)),C=null!=M?M.success?M.warnings:M.errors:void 0;(0,z.useEffect)(()=>{""===j?(Z(void 0),T.cancel()):T(j)},[T,j]);let O=e=>{try{P({raw_spec:JSON.stringify(JSON.parse(e),null,2)})}catch{try{P({raw_spec:eo.ZP.stringify(eo.ZP.parse(e),{lineWidth:120,indent:2})})}catch{}}};return(0,_.jsxs)("div",{className:"h-full overflow-auto px-4 pb-12 text-sm",children:[(0,_.jsxs)("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[(0,_.jsx)("div",{className:"absolute left-0 top-6",children:(0,_.jsx)(es.z,{color:"neutral",onClick:u,children:(0,_.jsx)(er.L7,{className:"icon-md"})})}),null!=x&&(0,_.jsx)("div",{className:"absolute right-0 top-6",children:(0,_.jsx)(es.z,{color:"neutral",onClick:()=>{window.confirm("Are you sure you want to delete this action?")&&(d(e=>eF(eF({},e),{},{tools:e.tools.filter(e=>e.type!==g.qK.JIT_PLUGIN||e.metadata.domain!==m)})),u())},className:"text-red-500",children:(0,_.jsx)(er.a_,{className:"icon-md"})})}),(0,_.jsx)("div",{className:"text-xl font-medium",children:v?(0,_.jsx)(en.Z,{id:"LEn2vt",defaultMessage:"Add actions"}):(0,_.jsx)(en.Z,{id:"WtVYgh",defaultMessage:"Edit actions"})}),(0,_.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,_.jsx)(en.Z,{id:"f0WG0Q",defaultMessage:"Let your GPT retrieve information or take actions outside of ChatGPT."})}),(0,_.jsx)("div",{className:"text-sm text-token-text-tertiary",children:(0,_.jsx)("a",{href:"https://help.openai.com/en/articles/8554397-creating-a-gpt",target:"_blank",rel:"noreferrer",className:"font-medium",children:(0,_.jsx)(en.Z,{id:"44M7/B",defaultMessage:"Learn more."})})})]}),(0,_.jsxs)(eh.hj,{className:"relative",children:[(0,_.jsx)(eh.lX,{label:p.formatMessage({id:"kZ040s",defaultMessage:"Authentication"})}),(0,_.jsx)(eR,{onClick:()=>{w(!0)},content:p.formatMessage(function(e){switch(e){case ea.Jv.None:return(0,el.Em)({id:"G9qfIC",defaultMessage:"None"});case ea.Jv.OAuth:return(0,el.Em)({id:"t8MwwT",defaultMessage:"OAuth"});case ea.Jv.ServiceHTTP:return(0,el.Em)({id:"rN0uCi",defaultMessage:"API Key"})}}(null!==(s=null==x||null===(r=x.metadata)||void 0===r||null===(r=r.auth)||void 0===r?void 0:r.type)&&void 0!==s?s:ea.Jv.None)),button:(0,_.jsx)("button",{color:"neutral",className:"flex items-center gap-2 px-3",children:(0,_.jsx)(er.RR,{className:"icon-sm"})})}),b&&(0,_.jsx)(eJ,{jitPluginTool:x,onUpdateTool:e=>{switch(e.type){case ea.Jv.None:P({auth:{type:ea.Jv.None}});break;case ea.Jv.OAuth:{let{oauth_client_id:t,oauth_client_secret:i}=e;P({auth:(0,ei.Z)(e,eD),oauth_client_id:t,oauth_client_secret:i});break}case ea.Jv.ServiceHTTP:{let{api_key:t}=e;P({auth:(0,ei.Z)(e,eV),api_key:t})}}},onClose:()=>{w(!1)}})]}),(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"mb-1 flex h-8 items-center justify-between",children:[(0,_.jsx)("label",{className:"font-medium text-token-text-primary",children:(0,_.jsx)(en.Z,{id:"+xKwQg",defaultMessage:"Schema"})}),(0,_.jsx)("div",{className:"flex items-center",children:k?(0,_.jsx)(eY,{onImport:e=>{O(e)},onClose:()=>{N(!1)}}):(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[(0,_.jsx)(eU.cY,{color:"neutral",onClick:()=>{N(!0)},children:(0,_.jsx)(en.Z,{id:"kTR+Ef",defaultMessage:"Import from URL"})}),(0,_.jsx)(eu,{onSelectExample:e=>{P({raw_spec:e})}})]})})]}),(0,_.jsxs)("div",{className:"mb-8 overflow-hidden rounded-lg border border-token-border-light",children:[(0,_.jsxs)("div",{className:"relative",children:[(0,_.jsx)("textarea",{value:j,onChange:e=>{P({raw_spec:e.target.value})},spellCheck:!1,placeholder:p.formatMessage({id:"zBM3o0",defaultMessage:"Enter your OpenAPI schema here"}),className:"block h-96 w-full border-none bg-transparent p-2 font-mono text-xs text-token-text-primary"}),(0,_.jsx)("div",{className:"absolute bottom-2 right-2 flex gap-2",children:""!==j?(0,_.jsx)(eU.cY,{onClick:()=>{O(j)},children:(0,_.jsx)(en.Z,{id:"vJWnIM",defaultMessage:"Format"})}):(0,_.jsxs)(eU.cY,{as:"a",to:eq,openNewTab:!0,children:[(0,_.jsx)(en.Z,{id:"gizmo.actions.actionsGptHelp",defaultMessage:"Get help from ActionsGPT"}),(0,_.jsx)(er.fe,{className:"icon-md"})]})})]}),null!=C&&(null==C?void 0:C.length)>0&&(0,_.jsx)("div",{className:"border-t border-token-border-light p-2 text-red-500",children:C.map((e,t)=>(0,_.jsx)("div",{children:e},t))})]})]}),null!=M&&(0,_.jsx)(eK,{validationResponse:M}),(0,_.jsxs)("div",{className:"mt-4",children:[(0,_.jsx)(eh.lX,{label:p.formatMessage({id:"Pbk0Gp",defaultMessage:"Privacy policy"}),description:"Privacy policy is required for all public GPTs."}),(0,_.jsx)(ec.Z,{name:"privacyPolicyUrl",value:null!==(n=null==x||null===(l=x.metadata)||void 0===l?void 0:l.privacy_policy_url)&&void 0!==n?n:"",placeholder:"https://api.example-weather-app.com/privacy",onChange:e=>{P({privacy_policy_url:e.target.value})}})]})]})}var eX=i(43383),e$=i(82245),e0=i(99715),e1=i(22189),e2=i(5667),e3=i(74908),e4=i(68832),e5=i(93031),e8=i(70917),e6=i(13038),e9=i(913),e7=i(82473),te=i(61236),tt=i(4373),ti=i(27160),ta=i(57849),ts=i(98682),tr=i(43803),tn=i(47609);function tl(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function to(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tl(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tl(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let tc={can_read:!0,can_view_config:!1,can_write:!1,can_delete:!1,can_export:!1,can_share:!1},td={can_read:!0,can_view_config:!0,can_write:!1,can_delete:!1,can_export:!1,can_share:!1},tu=[tc,td],tp=[b.LA.USER,b.LA.GROUP,b.LA.WORKSPACE,b.LA.ALL],tm={[b.LA.USER]:b.Zz.User,[b.LA.GROUP]:b.Zz.Group,[b.LA.WORKSPACE]:b.Zz.Workspace,[b.LA.ALL]:b.Zz.Marketplace},th={[b.Zz.User]:b.LA.USER,[b.Zz.Group]:b.LA.GROUP,[b.Zz.WorkspaceLink]:b.LA.WORKSPACE,[b.Zz.Workspace]:b.LA.WORKSPACE,[b.Zz.Link]:b.LA.ALL,[b.Zz.Marketplace]:b.LA.ALL};function tg(e){var t,i,a,s,r,n,l,o,c,d,u;let{gizmo:p,publishedGizmo:h,promoteGizmo:g,appealGizmo:f,showActionsModal:x,workspaceSharing:v,onClose:w}=e,k=(0,et.Z)(),N=(0,U.t)(),P=null!==(t=null==N||null===(i=N.data)||void 0===i?void 0:i.name)&&void 0!==t?t:"your workspace",M=(0,V.aF)(),Z=(0,m.Z1)(),{0:T,1:C}=(0,z.useState)(void 0);(0,z.useEffect)(()=>{if(void 0==T){if(null!=h&&h.gizmo.display.categories&&(null==h?void 0:h.gizmo.display.categories.length)>0){var e;let t=null===(e=Z.data)||void 0===e?void 0:e.categories.find(e=>e.id===(null==h?void 0:h.gizmo.display.categories[0]));t&&C(t)}else void 0!=Z.data&&C(Z.data.categories[Z.data.categories.length-1])}},[Z.data,T,h]);let{0:O,1:S}=(0,z.useState)(null!==(a=p.sharingRecipient)&&void 0!==a?a:b.Zz.Private),{0:A,1:I}=(0,z.useState)(function(e,t){if(e===b.Zz.Private||t.find(t=>t.type===th[e]))return t;{let i=th[e];if(void 0==i||!(0,b.qX)(i))throw Error("Unknown sharing recipient type: "+e);return[...t,{type:i,capabilities:tc}]}}(null!==(s=p.sharingRecipient)&&void 0!==s?s:b.Zz.Private,null!==(r=null===(n=p.sharing)||void 0===n?void 0:n.subjects)&&void 0!==r?r:[])),{0:E,1:G}=(0,z.useState)(null),{0:L,1:R}=(0,z.useState)(!1),D=(0,e7.NL)();if(E)return(0,_.jsx)(tb,{publishedGizmo:E,sharing:{recipient:O,subjects:A},workspaceSharing:v,onClose:w});let B=0===A.length?null:A.reduce((e,t)=>tp.indexOf(t.type)<tp.indexOf(e.type)?e:t,A[0]);function F(e){let t=A.filter(e=>-1===[b.LA.WORKSPACE,b.LA.ALL].indexOf(e.type));null!=e&&t.push(e),I(t)}function q(e){switch(S(e),e){case b.Zz.Marketplace:case b.Zz.Link:F({type:b.LA.ALL,capabilities:tc});break;case b.Zz.Workspace:case b.Zz.WorkspaceLink:F({type:b.LA.WORKSPACE,capabilities:tc});break;default:F(null)}}function W(e){null!=B&&I(A.map(t=>t===B?to(to({},t),{},{capabilities:e}):t))}function J(e){return to(to({},e),{},{type:tm[e.type]})}function Y(e,t,i){return e.type===b.LA.USER&&-1===e.user_id.indexOf("__")?to(to({},e),{},{user_id:e.user_id+"__"+(null==N?void 0:N.getWorkspaceId())}):e}async function H(){if(L||!T)return;R(!0);let e=await g({subjects:A,recipient:O},T.id),t=A.map(Y).map(J);t.push({type:O,capabilities:tc}),await y.U.shareGizmo(e.gizmo.id,t),D.invalidateQueries({queryKey:["gizmo",e.gizmo.id]}),G(null!=e?e:null),R(!1)}return(0,_.jsx)(j.Z,{type:"success",className:"w-[555px]",isOpen:!0,onClose:w,primaryButton:(0,_.jsx)(es.z,{onClick:()=>H(),disabled:L,children:(0,_.jsx)(en.Z,{id:"h7gnqc",defaultMessage:"Save"})}),secondaryButton:null,title:k.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:(0,_.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,_.jsx)(tN,{onAdd:e=>{A.find(t=>t.type===b.LA.USER?t.user_id===e.user_id:t.type===b.LA.GROUP?t.group_id===e.group_id:t.type===e.type)||I([...A,e])}}),(0,_.jsx)("h3",{className:"text-base font-medium",children:(0,_.jsx)(en.Z,{id:"bNQXcV",defaultMessage:"Share with..."})}),(0,_.jsxs)("div",{className:"max-h-[200px] overflow-y-scroll",children:[(0,_.jsx)("div",{className:"flex flex-row items-center justify-between space-x-3",children:(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"text-base font-medium",children:(0,_.jsx)(en.Z,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:null==M?void 0:M.name}})}),(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"text-sm text-token-text-secondary",children:null==M?void 0:M.email})]})}),A.map((e,t)=>(0,b.h)(e)&&(0,_.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-3",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"text-base font-medium",children:e.type===b.LA.GROUP?e.group_name:e.user_name}),e.type===b.LA.USER&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.user_email})]})]}),(0,_.jsxs)(e8.Z.Root,{children:[(0,_.jsxs)(e8.Z.Trigger,{className:"text-token-text-secondary",children:[(0,_.jsx)(en.Z,to({},tv(e.capabilities))),(0,_.jsx)(eT.bTu,{})]}),(0,_.jsx)(e8.Z.Portal,{children:(0,_.jsxs)(e8.Z.Content,{children:[tu.map((t,i)=>(0,_.jsx)(e8.Z.Item,{onClick:()=>{I(A.map(i=>i===e?to(to({},i),{},{capabilities:t}):i))},children:(0,_.jsx)(en.Z,to({},tv(t)))},i)),(0,_.jsx)(e8.Z.Item,{onClick:()=>I(A.filter(t=>t!==e)),className:"text-red-600",children:(0,_.jsx)(en.Z,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},t))]}),(0,_.jsx)("hr",{}),(0,_.jsx)("h3",{className:"text-base font-medium",children:(0,_.jsx)(en.Z,{id:"uqD7Y8",defaultMessage:"Access"})}),(0,_.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-3",children:[(0,_.jsx)("span",{className:"text-base font-medium",children:(0,_.jsxs)(e8.Z.Root,{children:[(0,_.jsxs)(e8.Z.Trigger,{className:"-ml-3 h-fit pl-2",children:[(0,_.jsx)(ty,{shareLevel:O,workspaceName:P}),(0,_.jsx)(eT.bTu,{className:"shrink-0"})]}),(0,_.jsx)(e8.Z.Portal,{children:(0,_.jsxs)(e8.Z.Content,{className:"ml-[-5px]",children:[(0,_.jsx)(tf,{children:(0,_.jsx)(en.Z,{id:"YIQwaP",defaultMessage:"Private"})}),(0,_.jsx)(e8.Z.Item,{className:"h-14",onClick:()=>q(b.Zz.Private),children:(0,_.jsx)(ty,{shareLevel:b.Zz.Private,workspaceName:P})}),(0,_.jsx)(tf,{children:P}),(0,_.jsx)(e8.Z.Item,{className:"h-14",onClick:()=>q(b.Zz.WorkspaceLink),disabled:(null===(l=p.sharingTargets)||void 0===l?void 0:l.find(e=>"workspace_link"===e.recipient||"workspace"===e.recipient))===void 0,children:(0,_.jsx)(ty,{shareLevel:b.Zz.WorkspaceLink,workspaceName:P})}),(0,_.jsx)(e8.Z.Item,{className:"h-14",onClick:()=>q(b.Zz.Workspace),disabled:(null===(o=p.sharingTargets)||void 0===o?void 0:o.find(e=>"workspace_link"===e.recipient||"workspace"===e.recipient))===void 0,children:(0,_.jsx)(ty,{shareLevel:b.Zz.Workspace,workspaceName:P})}),(0,_.jsx)(tf,{children:(0,_.jsx)(en.Z,{id:"PjY9bi",defaultMessage:"Public"})}),(0,_.jsx)(e8.Z.Item,{className:"h-14",onClick:()=>q(b.Zz.Link),disabled:(null===(c=p.sharingTargets)||void 0===c?void 0:c.find(e=>"link"===e.recipient))===void 0,children:(0,_.jsx)(ty,{shareLevel:b.Zz.Link,workspaceName:P})}),(0,_.jsx)(e8.Z.Item,{className:"h-14",disabled:(null===(d=p.sharingTargets)||void 0===d?void 0:d.find(e=>"marketplace"===e.recipient))===void 0,onClick:()=>q(b.Zz.Marketplace),children:(0,_.jsx)(ty,{shareLevel:b.Zz.Marketplace,workspaceName:P})})]})})]})}),O!==b.Zz.Private&&O!==b.Zz.User&&(0,_.jsxs)(e8.Z.Root,{children:[(0,_.jsxs)(e8.Z.Trigger,{className:"text-token-text-secondary",children:[null==B?(0,_.jsx)(en.Z,to({},tv(tc))):(0,_.jsx)(en.Z,to({},tv(B.capabilities))),(0,_.jsx)(eT.bTu,{})]}),(0,_.jsx)(e8.Z.Portal,{children:(0,_.jsxs)(e8.Z.Content,{children:[(0,_.jsx)(e8.Z.Item,{onClick:()=>W(tc),children:(0,_.jsx)(en.Z,to({},tv(tc)))}),O!==b.Zz.Marketplace&&(0,_.jsx)(e8.Z.Item,{onClick:()=>W(td),children:(0,_.jsx)(en.Z,to({},tv(td)))})]})})]})]}),(O===b.Zz.Marketplace||O===b.Zz.Workspace)&&(0,_.jsx)(tw,{gizmo:p,category:T,categories:null===(u=Z.data)||void 0===u?void 0:u.categories,onCategoryChange:e=>C(e)})]})})}let tf=P.Z.p(d||(d=(0,x.Z)(["text-base text-token-text-secondary font-medium pl-4 pt-3 pr-4 pb-1"]))),tx=(0,el.vU)({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"L2+SyY",defaultMessage:"Publish to {workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"3URUPp",defaultMessage:"Publish to GPT Store"}});function tv(e){return e.can_write?(0,el.Em)({id:"SubCqD",defaultMessage:"Can edit"}):e.can_view_config?(0,el.Em)({id:"I5rzV3",defaultMessage:"Can view config"}):e.can_read?(0,el.Em)({id:"/0j34W",defaultMessage:"Can chat"}):(0,el.Em)({id:"x2E8ET",defaultMessage:"Unknown"})}let tj={private:ts.Z,user:ts.Z,group:ts.Z,workspace_link:ta.Z,workspace:ti.Z,link:ta.Z,marketplace:er.hk};function ty(e){let{shareLevel:t,workspaceName:i}=e,a=tj[t];return(0,_.jsxs)("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-medium",children:[(0,_.jsx)(a,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),(0,_.jsx)(en.Z,to(to({},tx[t]),{},{values:{workspaceName:i}}))]})}function tb(e){var t;let{publishedGizmo:i,sharing:a,workspaceName:s,onClose:r}=e,n=a.recipient,l=tj[n];return(0,_.jsxs)(j.Z,{isOpen:!0,onClose:r,showCloseButton:!0,className:"w-[304px]",title:(0,_.jsx)(en.Z,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:(0,_.jsx)(es.z,{onClick:()=>{window.location.href="/g/".concat(i.gizmo.id)},children:(0,_.jsx)(en.Z,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:(0,_.jsx)(es.z,{color:"neutral",children:(0,_.jsx)(en.Z,{id:"D65uBd",defaultMessage:"Copy Link"})}),type:"success",children:[(0,_.jsx)(tw,{gizmo:{profilePictureUrl:null!==(t=i.gizmo.display.profile_picture_url)&&void 0!==t?t:void 0,name:i.gizmo.display.name}}),a.subjects.filter(e=>(0,b.h)(e)).length>0&&(0,_.jsxs)("div",{className:"my-4",children:[(0,_.jsx)("h4",{className:"text-xs font-medium text-token-text-secondary",children:(0,_.jsx)(en.Z,{id:"/paYH9",defaultMessage:"Shared with"})}),a.subjects&&a.subjects.map((e,t)=>(0,b.h)(e)&&(0,_.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-3",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("span",{className:"text-base font-medium",children:e.type===b.LA.GROUP?e.group_name:e.user_name}),e.type===b.LA.USER&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("br",{}),(0,_.jsx)("span",{className:"text-sm text-token-text-secondary",children:e.user_email})]})]}),(0,_.jsx)("span",{className:"text-token-text-secondary",children:(0,_.jsx)(en.Z,to({},tv(e.capabilities)))})]},t))]}),(0,_.jsxs)("div",{className:"my-4",children:[(0,_.jsx)("h4",{className:"text-xs font-medium text-token-text-secondary",children:(0,_.jsx)(en.Z,{id:"q9XNZ7",defaultMessage:"Access"})}),(0,_.jsxs)("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-medium",children:[(0,_.jsx)(l,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),(0,_.jsxs)("div",{className:"flex flex-col",children:[(0,_.jsx)("span",{children:(0,_.jsx)(en.Z,to(to({},tx[n]),{},{values:{workspaceName:s}}))}),(n===b.Zz.Workspace||n===b.Zz.Marketplace)&&(0,_.jsx)("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function tw(e){let{gizmo:t,category:i,categories:a,onCategoryChange:s}=e,{data:r,isLoading:n}=(0,m.WL)();return(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:(0,Q.default)("mb-[1px] flex flex-row items-center  space-x-2 bg-token-main-surface-secondary p-4",n&&"invisible",a?"rounded-t-lg":"rounded-lg"),children:[(0,_.jsx)(eX.Z,{isFirstParty:!1,className:"h-11 w-11",src:t.profilePictureUrl}),(0,_.jsxs)("div",{className:"flex grow flex-col space-y-0",children:[(0,_.jsx)("span",{className:"font-medium",children:t.name}),(0,_.jsx)(tn.ZP,{builderName:null==r?void 0:r.display_name,builderUrl:null==r?void 0:r.website_url,socials:[null==r?void 0:r.socials.linkedin,null==r?void 0:r.socials.github,null==r?void 0:r.socials.twitter].filter(e=>null!=e),className:"text-xs"})]})]}),a&&i&&(0,_.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary p-4",children:[(0,_.jsx)("span",{className:"text-base font-medium",children:(0,_.jsx)(en.Z,{id:"JcA4/t",defaultMessage:"Category"})}),s?(0,_.jsxs)(e8.Z.Root,{children:[(0,_.jsxs)(e8.Z.Trigger,{className:"bg-transparent text-token-text-secondary hover:bg-token-main-surface-tertiary",children:[i.title,(0,_.jsx)(eT.bTu,{})]}),(0,_.jsx)(e8.Z.Portal,{children:(0,_.jsx)(e8.Z.Content,{className:"text-token-text-secondary",children:a.map((e,t)=>(0,_.jsx)(e8.Z.Item,{onClick:()=>s(e),children:e.title},t))})})]}):(0,_.jsx)("span",{className:"text-token-text-secondary",children:i.title})]})]})}let tk=P.Z.li(u||(u=(0,x.Z)(["rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary"])));function tN(e){var t,i;let{onAdd:a}=e,s=(0,et.Z)(),r=(0,U.t)(),{0:n,1:l}=(0,z.useState)(""),{data:o}=(0,tt.Z)(null==r?void 0:r.id,0,n,5),{data:c}=(0,te.a)({queryKey:[null==r?void 0:r.id,"groups","filtered",n],queryFn:()=>e6.Z.getWorkspaceGroups(r.id,{query:n}),enabled:""!==n.trim()&&null!=r&&!!r.getWorkspaceId()}),d=(null!==(t=null==o?void 0:o.items.length)&&void 0!==t?t:0)>0||(null!==(i=null==c?void 0:c.items.length)&&void 0!==i?i:0)>0,{0:u,1:p}=(0,z.useState)(!1);return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{className:"flex w-full flex-row space-x-3",children:(0,_.jsxs)(e9.J,{as:"div",className:"group relative grow",children:[(0,_.jsx)(ec.Z,{list:"suggested-choices",name:"share-with-input",placeholder:s.formatMessage({id:"HLp5O4",defaultMessage:"Add people and groups"}),value:n,onChange:e=>l(e.target.value),onFocus:()=>p(!0),onBlur:()=>p(!1)}),(0,_.jsx)(tr.m,{show:""!==n.trim()&&d&&u,children:(0,_.jsx)(e9.J.Panel,{static:!0,className:"group-has-[:focus]:border-token-border-xheavy absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1",children:""!==n.trim()&&(0,_.jsxs)("ul",{id:"suggested-choices",children:[(null==o?void 0:o.items)&&o.items.map(e=>(0,_.jsxs)(tk,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>{var t,i,s;return t=e.id,i=e.name,s=e.email,void(r&&(a({type:b.LA.USER,user_id:t+"__"+r.getWorkspaceId(),user_name:i,user_email:s,capabilities:to({},tc)}),l("")))},children:[e.name," <",e.email,">"]},e.id)),(null==c?void 0:c.items)&&c.items.slice(0,5).map(e=>(0,_.jsx)(tk,{tabIndex:0,onClick:()=>{var t,i;return t=e.id,i=e.name,void(a({type:b.LA.GROUP,group_id:t,group_name:i,capabilities:to({},tc)}),l(""))},children:e.name},e.id))]})})})]})})})}var tz=i(47559);function tP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function t_(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tP(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tP(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function tM(e){window.history.length>1?e.back():e.push((0,q.L7)())}function tZ(e){var t,i,a;let{gizmo:s,publishedGizmo:r,promoteGizmo:n,appealGizmo:l,setStep:o,showActionsModal:c}=e,{0:d,1:u}=(0,z.useState)(!1),p=(0,V.ec)(V.F_.isBusinessWorkspace),h=(0,et.Z)(),{0:f,1:x}=(0,z.useState)((0,m.Sg)(s)?p?b.Zz.Workspace:b.Zz.Marketplace:s.sharingRecipient),v=(0,z.useMemo)(()=>(null==r?void 0:r.gizmo.sharing_targets)==null||r.gizmo.sharing_targets.some(e=>e.recipient===f&&e.allowed),[null==r?void 0:r.gizmo.sharing_targets,f]),{data:j,isLoading:k}=(0,m.WL)(),{0:N,1:P}=(0,z.useState)(null!=r&&r.gizmo.display.categories.length>0?r.gizmo.display.categories[0]:void 0);(0,z.useEffect)(()=>{P(null==r?void 0:r.gizmo.display.categories[0])},[null==r?void 0:r.gizmo.display.categories]);let{0:M,1:Z}=(0,z.useState)(void 0),T=(0,z.useRef)((0,X.throttle)((e,t)=>y.U.generateCategory(e,t),1e3)),C=null!=j&&j.is_verified?void 0:h.formatMessage(tR.displayNameRequiredHint);f!==b.Zz.Marketplace||null==C||k||x(b.Zz.Link);let O=p&&!(null!==(t=s.sharingTargets)&&void 0!==t&&t.some(e=>e.recipient===b.Zz.Link)),S=(0,e5.bw)(s,f,N),A=S.includes(e5.hs.MissingPublicActionPrivacyPolicyURL),I=s.tools.find(e=>e.type===g.qK.JIT_PLUGIN&&!e.metadata.privacy_policy_url),E=(0,V.ec)(e=>e.currentWorkspace),G=(0,U.hz)(),L=(0,m.Z1)();(0,z.useEffect)(()=>{if(!(null!=G&&G.includes(R.L0.GizmoStore))){P("other");return}let e=!0;return(async()=>{try{if(null!=N)return;let t=await T.current(s.name,s.instructions);e&&null==N&&(t?P(t.id):Z(!0))}catch(t){e&&null==N&&Z(!0)}})(),()=>{e=!1}},[s.instructions,s.name,G,N]);let D=null==G?void 0:G.includes(R.L0.GizmoStore),{value:B}=(0,w.sB)(w.tz.GizmoAppeals);return(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"mb-2 text-sm font-medium text-token-text-tertiary",children:(0,_.jsx)(en.Z,t_({},tR.publishTo))}),(0,_.jsxs)("div",{className:"flex flex-col gap-3 text-sm",children:[(0,_.jsxs)(W.fC,{value:f,onValueChange:e=>x(e),className:"space-y-2",children:[s.sharingTargets&&s.sharingTargets.map((e,t)=>(0,_.jsx)(eU.Xb,{value:e.recipient,disabled:e.recipient===b.Zz.Marketplace&&null!=C,tooltipText:e.recipient===b.Zz.Marketplace?(null!=C?C:D)?h.formatMessage(tR.publicSharingHintStoreEnabled):h.formatMessage(tR.publicSharingHint):void 0,label:(0,eb.MI)(e.recipient,E,h)},t)),O&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(eU.Xb,{value:b.Zz.Link,disabled:!0,tooltipText:h.formatMessage(tR.workspaceDisabledHint),label:(0,eb.MI)(b.Zz.Link,E,h)}),(0,_.jsx)(eU.Xb,{value:b.Zz.Marketplace,disabled:!0,tooltipText:h.formatMessage(tR.workspaceDisabledHint),label:(0,eb.MI)(b.Zz.Marketplace,E,h)})]})]}),A&&(0,_.jsx)("div",{className:"text-xs text-red-500",children:(0,_.jsx)(en.Z,t_(t_({},tR.actionNeedsPrivacyPolicyURL),{},{values:{fixlink:e=>(0,_.jsx)("button",{onClick:()=>{c(null==I?void 0:I.metadata.action_id)},className:"underline",children:e})}}))}),f!==b.Zz.Private&&(0,_.jsx)(tz.QT,{gizmoAvatar:s.profilePictureUrl,gizmoName:s.name,canEdit:!0}),f===b.Zz.Marketplace&&(null==G?void 0:G.includes(R.L0.GizmoStore))&&(M?(0,_.jsx)("div",{className:"text-xs text-red-500",children:(0,_.jsx)(en.Z,t_({},tR.categoryError))}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"flex items-center justify-between text-sm font-medium text-token-text-tertiary",children:[(0,_.jsx)(en.Z,t_({},tR.categoryLabel)),(0,_.jsx)(e4.u,{label:(0,_.jsx)("span",{className:"w-36 text-xs",children:(0,_.jsx)(en.Z,t_({},tR.categoryLabelTooltip))}),side:"top",children:(0,_.jsx)(er.VX,{className:"icon-sm"})})]}),(0,_.jsx)(tL,{category:null!=N?N:"",categories:null!==(i=null===(a=L.data)||void 0===a?void 0:a.categories)&&void 0!==i?i:[],setCategory:P})]})),v?(0,_.jsx)(eU.cY,{color:"primary",disabled:S.length>0,loading:d,onClick:async()=>{try{u(!0);let e=await n({recipient:f,subjects:[]},N);if(null==e)return;1===e.gizmo.live_version?ee().push((0,m.m_)(e)):o({type:"published",publishedGizmo:e})}finally{u(!1)}},className:"w-full",children:(0,_.jsx)(en.Z,t_({},tR.privacyConfirm))}):B?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:(0,_.jsx)(en.Z,t_({},tR.appealNeededLabel))}),(0,_.jsx)(eU.cY,{color:"primary",onClick:async()=>{await l(f,N)},className:"w-full",children:(0,_.jsx)(en.Z,t_({},tR.appealButton))})]}):(0,_.jsx)("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:(0,_.jsx)(en.Z,t_({},tR.recipientBlocked))})]})]})}function tT(e){return"".concat("https://chat.openai.com").concat((0,m.m_)(e))}function tC(e){let{publishedGizmo:t}=e,i=tT(t);return(0,_.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,_.jsx)("div",{className:"font-medium",children:(0,_.jsx)(en.Z,t_({},tR.publishedTitle))}),(0,_.jsxs)("div",{className:"flex gap-1 rounded bg-token-main-surface-secondary px-2 py-1",children:[(0,_.jsx)("div",{className:"text-ellipsis break-all line-clamp-1",children:i}),(0,_.jsx)("button",{onClick:()=>{(0,e3.v)(tT(t))},className:"text-token-text-secondary transition hover:text-token-text-primary",children:(0,_.jsx)(er.dS,{className:"icon-sm"})})]}),(0,_.jsx)(eU.cY,{color:"primary",as:"link",to:i,className:"w-full",children:(0,_.jsx)(en.Z,t_({},tR.viewGPT))})]})}function tO(e){let{gizmo:t,publishedGizmo:i,promoteGizmo:a,appealGizmo:s,showActionsModal:r}=e,{0:n,1:l}=(0,z.useState)({type:"privacy"});return(0,_.jsx)("div",{className:"w-60 rounded-lg border border-token-border-medium bg-token-main-surface-primary p-4 text-sm",children:"privacy"===n.type?(0,_.jsx)(tZ,{gizmo:t,publishedGizmo:i,promoteGizmo:a,appealGizmo:s,setStep:l,showActionsModal:r}):(0,_.jsx)(tC,{publishedGizmo:n.publishedGizmo})})}function tS(e){var t;let{gizmo:i,publishedGizmo:a,isLoading:s,isUploadingProfilePic:r,isGeneratingProfilePic:n,promoteGizmo:l,appealGizmo:o,hasUnpublishedChanges:c,showActionsModal:d}=e,u=(0,U.t)(),p=null!=i?(0,e5.bw)(i):[],h=(0,et.Z)();(null==i||s)&&p.push(e5.hs.Loading),r&&p.push(e5.hs.UploadingProfilePic),n&&p.push(e5.hs.GeneratingProfilePic);let{value:g}=(0,w.sB)(w.tz.UpdatedGizmoShare),f=(0,m.Sg)(i),{0:x,1:v}=(0,z.useState)(!1);return g?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(eU.cY,{color:"primary",onClick:()=>v(!0),children:(0,_.jsx)(en.Z,{id:"MAqc/D",defaultMessage:"Save"})}),x&&(0,_.jsx)(tg,{gizmo:i,publishedGizmo:a,promoteGizmo:l,appealGizmo:o,showActionsModal:d,onClose:()=>v(!1),workspaceSharing:(null==u?void 0:u.getWorkspaceId())!=void 0})]}):(0,_.jsxs)(e1.fC,{modal:!0,children:[(0,_.jsx)(e1.xz,{asChild:!0,children:(0,_.jsx)(eU.cY,{color:"primary",className:"cursor-pointer whitespace-nowrap",disabled:void 0===i.id,tooltip:p.length>0?p.map(e5.sw).join("\n"):void 0,children:(0,_.jsxs)("div",{className:"flex items-center gap-1",children:[c&&!f?h.formatMessage({id:"5D5nYS",defaultMessage:"Update"}):h.formatMessage({id:"MAqc/D",defaultMessage:"Save"}),(0,_.jsx)(er.ud,{})]})})}),(0,_.jsx)(e1.h_,{children:(0,_.jsx)(e1.VY,{side:"bottom",align:"end",sideOffset:8,children:(0,_.jsx)(tO,{gizmo:i,publishedGizmo:a,promoteGizmo:l,appealGizmo:o,showActionsModal:d})})})]})}function tA(e){let{gizmoEditorData:t,publishedGizmo:i,revertDraft:a}=e,s=(0,et.Z)(),{0:r,1:n}=(0,z.useState)(!1),l=(0,U.hz)(),{value:o}=(0,w.sB)(w.tz.GizmoVersionHistory);return null!=l&&l.includes("debug")||(null==t?void 0:t.id)!=null?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(e0.fC,{children:[(0,_.jsx)(e0.xz,{asChild:!0,children:(0,_.jsx)(eU.cY,{children:(0,_.jsx)(er.Yr,{className:"icon-md"})})}),(0,_.jsx)(e0.Uv,{children:(0,_.jsxs)(e0.VY,{className:"popover min-w-[180px] max-w-xs rounded-lg border border-token-border-light bg-token-main-surface-primary shadow-lg",side:"top",align:"end",sideOffset:6,children:[null!=i&&(0,_.jsxs)(eU.UA,{onClick:()=>{(0,e3.v)(tT(i))},children:[(0,_.jsx)(er.HN,{className:"icon-md"}),(0,_.jsx)(en.Z,t_({},tR.copyLink))]}),null!=a&&(0,_.jsxs)(eU.UA,{onClick:()=>{window.confirm(s.formatMessage(tR.revertConfirm))&&a()},children:[(0,_.jsx)(er.Nt,{className:"icon-md"}),(0,_.jsx)(en.Z,t_({},tR.revertMenuItem))]}),(null==l?void 0:l.includes("debug"))&&(0,_.jsxs)(eU.UA,{onClick:()=>{ek.vm.toggleActiveSidebar("debug")},children:[(0,_.jsx)(er.WP,{className:"icon-md"}),"Debug (Internal only)"]}),(null==t?void 0:t.id)!=null&&(0,_.jsxs)(eU.UA,{color:"danger",onClick:()=>{n(!0)},children:[(0,_.jsx)(er.a_,{className:"icon-md"}),(0,_.jsx)(en.Z,t_({},tR.deleteGPT))]}),o&&(0,_.jsxs)(eU.UA,{onClick:()=>{ee().push("/g/".concat(t.id,"/view"))},children:[(0,_.jsx)(er.a_,{className:"icon-md"}),(0,_.jsx)(en.Z,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]})]})})]}),r&&(0,_.jsx)(e$.b,{gizmoId:t.id,onSuccess:()=>tM(ee()),onClose:()=>{n(!1)}})]}):null}let tI=P.Z.div(p||(p=(0,x.Z)(["flex items-center gap-1"])));function tE(e){let{gizmoEditorData:t}=e,i=(0,V.ec)(e=>{var t;return null===(t=e.currentWorkspace)||void 0===t?void 0:t.name});switch(t.sharingRecipient){case b.Zz.Private:return(0,_.jsxs)(tI,{children:[(0,_.jsx)(er.LX,{className:"icon-xs"}),(0,_.jsx)(en.Z,t_({},tR.onlyMe))]});case b.Zz.Link:return(0,_.jsxs)(tI,{children:[(0,_.jsx)(er.HN,{className:"icon-xs"}),(0,_.jsx)(en.Z,t_({},tR.anyoneWithLink))]});case b.Zz.Workspace:return(0,_.jsxs)(tI,{children:[(0,_.jsx)(er.oq,{className:"icon-xs"}),i]});case b.Zz.Marketplace:return(0,_.jsxs)(tI,{children:[(0,_.jsx)(er.hk,{className:"icon-xs"}),(0,_.jsx)(en.Z,t_({},tR.public))]})}return(0,_.jsx)("div",{})}function tG(e){let{gizmoEditorData:t}=e;return(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[null!=t.profilePictureUrl?(0,_.jsx)(eX.Z,{isFirstParty:!1,src:t.profilePictureUrl,className:"h-8 w-8"}):(0,_.jsx)("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{className:"text-sm font-medium",children:t.name||(0,_.jsx)(en.Z,t_({},tR.newGPT))}),(0,_.jsx)("div",{className:"text-xs text-token-text-secondary",children:(0,m.Sg)(t)?(0,_.jsxs)("div",{className:"flex items-center gap-1",children:[(0,_.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),(0,_.jsx)(en.Z,t_({},tR.draft))]}):(0,_.jsxs)("div",{className:"flex items-center gap-1",children:[(0,_.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),(0,_.jsx)(en.Z,t_({},tR.published))," \xb7 ",(0,_.jsx)(tE,{gizmoEditorData:t})]})})]})]})}function tL(e){let{category:t,categories:i,setCategory:a}=e;return(0,_.jsxs)(e2.fC,{value:t,onValueChange:e=>a(e),children:[(0,_.jsx)(e2.xz,{className:"flex justify-between rounded-xl bg-gray-50 p-3 font-medium dark:bg-gray-900",children:t?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(e2.B4,{}),(0,_.jsx)(e2.JO,{children:(0,_.jsx)(er.ud,{})})]}):(0,_.jsx)("div",{className:"flex w-full justify-center",children:(0,_.jsx)(G.Z,{})})}),(0,_.jsx)(e2.h_,{children:(0,_.jsx)(e2.VY,{className:"h-64 w-[var(--radix-select-trigger-width)] rounded-xl border bg-token-main-surface-primary p-1 py-2 dark:border-gray-600",position:"popper",sideOffset:2,children:(0,_.jsx)("div",{className:"overflow-y-auto",children:i.map(e=>(0,_.jsxs)(e2.ck,{className:"flex w-full cursor-pointer justify-between rounded-lg p-2 pl-4 text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-700",value:e.id,children:[(0,_.jsx)(e2.eT,{children:e.title}),(0,_.jsx)(e2.wU,{className:"text-green-600",children:(0,_.jsx)(er.oS,{})})]},e.id))})})})]})}function tU(e){let{gizmoEditorData:t,isLoading:i,isUploadingProfilePic:a,isGeneratingProfilePic:s,publishedGizmo:r,promoteGizmo:n,appealGizmo:l,revertDraft:o,draftMessage:c,className:d,hasUnpublishedChanges:u,showActionsModal:p}=e;return(0,_.jsxs)("div",{className:(0,Q.default)("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",d),children:[(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[(0,_.jsx)("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>tM(ee()),children:(0,_.jsx)(er.L7,{className:"icon-lg"})}),(0,_.jsx)(tG,{gizmoEditorData:t})]}),(0,_.jsxs)("div",{className:"flex items-center gap-2",children:[c,(0,_.jsx)(tA,{gizmoEditorData:t,publishedGizmo:r,revertDraft:o}),(0,_.jsx)(tS,{gizmo:t,publishedGizmo:r,isLoading:i,isUploadingProfilePic:a,isGeneratingProfilePic:s,promoteGizmo:n,appealGizmo:l,hasUnpublishedChanges:u,showActionsModal:p})]})]})}let tR=(0,el.vU)({privacyConfirm:{id:"gizmo.confirmPublish",defaultMessage:"Confirm"},recipientBlocked:{id:"gizmo.recipientBlocked",defaultMessage:"Because this GPT violates our policies, you will have to submit an appeal for it to be sharable."},appealNeededLabel:{id:"gizmo.appealNeededLabel",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."},appealButton:{id:"gizmo.appealButton",defaultMessage:"Appeal"},workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"},publicSharingHint:{id:"gizmo.publicSharingHint",defaultMessage:"This GPT may appear in the GPT Store (coming soon)"},publicSharingHintStoreEnabled:{id:"gizmo.publicSharingHintStoreEnabled",defaultMessage:"Your GPT will appear in the Explore GPTs page"},displayNameRequiredHint:{id:"gizmo.displayNameRequiredHint",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile."},deleteGPT:{id:"gizmo.delete",defaultMessage:"Delete GPT"},actionNeedsPrivacyPolicyURL:{id:"gizmo.actionNeedsPrivacyPolicyURL",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update."},publishTo:{id:"gizmo.publishTo",defaultMessage:"Publish to"},publishedTitle:{id:"gizmo.publishedTitle",defaultMessage:"Published!"},viewGPT:{id:"gizmo.viewGPT",defaultMessage:"View GPT"},revertMenuItem:{id:"gizmo.revertMenuItem",defaultMessage:"Revert..."},onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},categoryLabel:{id:"gizmo.categoryLabel",defaultMessage:"Category"},categoryLabelTooltip:{id:"gizmo.categoryLabelTooltip",defaultMessage:"Your GPT may appear in this category on the Explore page"},categoryError:{id:"gizmo.categoryError",defaultMessage:"Error generating category"}});function tD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function tV(e){let{upsertDraftError:t}=e,i=function(e,t){let i=e.response,a=(0,B.Ot)(e);if(!Array.isArray(i))return a;let s=(0,X.compact)(i.map(e=>{if("value_error.any_str.max_length"===e.type)switch(e.loc[1]){case"display":switch(e.loc[2]){case"name":return t.formatMessage(eh.sY.nameTooLong,{length:e.ctx.limit_value});case"description":return t.formatMessage(eh.sY.descriptionTooLong,{length:e.ctx.limit_value})}break;case"instructions":return t.formatMessage(eh.sY.instructionsTooLong,{length:e.ctx.limit_value})}if("string"==typeof e.msg)return e.msg}));return s.length>0?s.join("\n"):a}(t,(0,et.Z)());return(0,_.jsxs)("div",{className:"flex items-center gap-2 text-red-500",children:[(0,_.jsx)("div",{children:(0,_.jsx)(en.Z,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tD(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tD(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},tF.errorSavingDraft))}),null!=i&&(0,_.jsx)(e4.u,{label:i,children:(0,_.jsx)(eT.H33,{className:"icon-sm"})})]})}function tB(e){let{isSavingDraft:t,hasUnpublishedChanges:i,upsertDraftError:a,className:s}=e;return a instanceof B.Q0?(0,_.jsx)(tV,{upsertDraftError:a}):i?(0,_.jsxs)("div",{className:(0,Q.default)("flex items-center gap-2",s),children:[(0,_.jsx)("span",{className:"text-token-text-secondary",children:"Unpublished changes"}),(0,_.jsx)("div",{className:"w-4 text-token-text-tertiary",children:t&&(0,_.jsx)(G.Z,{})})]}):null}let tF=(0,el.vU)({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}});var tq=i(87106),tW=i(45072);function tJ(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function tY(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tJ(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tJ(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}async function tH(e){let t;for(let i of e)if("gizmo_editor.generate_profile_pic"===i.author.name&&"multimodal_text"===i.content.content_type)for(let e of i.content.parts)"object"==typeof e&&"asset_pointer"in e&&(t=e);if(null!=t){let e=(0,tq.Iy)(t.asset_pointer),i=await e6.Z.getFileDownloadLink(e);if(i.status===g.KF.Success)return{id:e,permalink:i.download_url}}}async function tK(e,t,i){var a,s;let r=function(e,t){let i=D.tQ.getThreadCurrentLeafId(e),a=D.tQ.getTree(e),s=[],r=a.getNodeByIdOrMessageId(i);for(;null!=r&&(null==t||r.id!==t);)s.unshift(r.message),r=""!==r.parentId?a.getNodeByIdOrMessageId(r.parentId):void 0;return s}(t,i),n=r.filter(e=>"gizmo_editor.update_behavior"===e.recipient).flatMap(e=>"text"===e.content.content_type?e.content.parts:"code"===e.content.content_type?[e.content.text]:[]).map(e=>JSON.parse(e)).reduce((e,t)=>tY(tY({},e),t),{}),l=await tH(r);if((0,X.isEmpty)(n)&&null==l)return;let{name:o,context:c,description:d,profile_pic_file_id:u,prompt_starters:p}=n;if(null!=u)try{let t=await e6.Z.getFileDownloadLink(u,e.id);t.status===g.KF.Success&&(l={id:u,permalink:t.download_url})}catch(e){console.error("Error while retrieving profile pic in update: ".concat(e)),L.m.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}let m={name:"string"==typeof o?o:void 0,description:"string"==typeof d?d:void 0,instructions:"string"==typeof c?c:void 0,promptStarters:Array.isArray(p)?p:void 0,profilePictureId:null===(a=l)||void 0===a?void 0:a.id,profilePictureUrl:null===(s=l)||void 0===s?void 0:s.permalink};return(0,X.pickBy)(m,e=>null!=e)}function tQ(e,t,i,a){var s,r,n,l,o,c,d,u,p,m,h;let g=i.current,f=a.current;if((0,X.isEqual)(g,f))return;let x={};g.name!==(null==f?void 0:f.name)&&(x.name=g.name),(null!==(s=g.description)&&void 0!==s?s:"")!==(null!==(r=null==f?void 0:f.description)&&void 0!==r?r:"")&&(x.description=null!==(m=g.description)&&void 0!==m?m:""),g.instructions!==(null!==(n=null==f?void 0:f.instructions)&&void 0!==n?n:"")&&(x.context=null!==(h=g.instructions)&&void 0!==h?h:"");let v=new Set(null!==(l=null==f||null===(o=f.files)||void 0===o?void 0:o.map(e=>e.file_id))&&void 0!==l?l:[]),j=new Set(null!==(c=null===(d=g.files)||void 0===d?void 0:d.map(e=>e.file_id))&&void 0!==c?c:[]),y=(null!==(u=g.files)&&void 0!==u?u:[]).filter(e=>!v.has(e.file_id)),b=(null!==(p=null==f?void 0:f.files)&&void 0!==p?p:[]).filter(e=>!j.has(e.file_id));if((0,X.isEmpty)(x)&&0===y.length&&0===b.length)return;let w=[];if(!(0,X.isEmpty)(x)){let e="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(x,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');w.push(tW.Cv.getTextAsMessage(e,ea.uU.System))}b.length>0&&w.push(tW.Cv.getTextAsMessage("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(b.map(e=>e.file_id).join(", ")),ea.uU.System)),y.length>0&&w.push(tW.Cv.getTextAsMessage("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(y.map(e=>e.file_id).join(", ")),ea.uU.System,{attachments:y.map(e=>({id:e.file_id,name:e.name,size:e.size}))})),w.length>0&&D.tQ.updateTree(e,e=>{let i=e.getNodeByIdOrMessageId(t).parentId;for(let a of w){let s=(0,eC.Z)();e.insertNodeBefore(t,{id:s,children:[],parentId:i,message:a,metadata:{isClientCreatedSystemMessage:!0}}),i=s}})}var tX=i(21643),t$=i(47934);function t0(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function t1(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?t0(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t0(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let t2=z.memo(function(e){let{gizmoEditorData:t,updateGizmo:i,clientThreadId:a,completionCallbackResponse:s,gizmoEditorDataRef:r,magicMakerBehaviorOverrides:n,magicMakerConversationGizmoEditorDataRef:l,requireGizmoId:o}=e,c=(0,z.useMemo)(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:n,getGizmoId:o}),[o,t,n]),d=(0,t$.gF)(e=>e.files.filter(e=>e.status===tX.X.Ready&&null!=e.gizmoId)),u=(0,z.useCallback)((e,t)=>{!function(e,t,i){if(0===i.length)return;let a=(0,eC.Z)(),s="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(i.map(e=>'"'.concat(e.fileId,'"')).join(", "));D.tQ.updateTree(e,e=>{let i=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:a,children:[],parentId:i,message:tW.Cv.getTextAsMessage(s,ea.uU.System),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t,d),tQ(e,t,r,l),function(e,t){let i="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",a=D.tQ.getThreadCurrentLeafId(e),s=D.tQ.getTree(e),r=s.getNodeByIdOrMessageId(a);for(;null!=r&&r.message.author.role!==ea.uU.User;){if("text"===r.message.content.content_type&&r.message.content.parts[0]===i)return;r=""!==r.parentId?s.getNodeByIdOrMessageId(r.parentId):void 0}D.tQ.updateTree(e,e=>{let a=e.getNodeByIdOrMessageId(t).parentId;e.insertNodeBefore(t,{id:(0,eC.Z)(),children:[],parentId:a,message:tW.Cv.getTextAsMessage(i,ea.uU.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}(e,t),i(e=>{var t;return t1(t1({},e),{},{files:[...null!==(t=e.files)&&void 0!==t?t:[],...(0,X.compact)(d.map(e=>{var t;return null!=e.fileId&&{file_id:e.fileId,name:e.file.name,size:e.file.size,type:e.file.type,last_modified:e.file.lastModified,file_size_tokens:null===(t=e.fileSpec)||void 0===t?void 0:t.fileTokenSize}}))]})}),l.current=(0,X.cloneDeep)(r.current)},[r,l,d,i]),p=(0,ek.tN)(e=>e.activeSidebar);return(0,_.jsx)(eS.D.Provider,{value:c,children:(0,_.jsxs)("div",{className:"relative flex h-full grow overflow-auto",children:[(0,_.jsx)("div",{className:"grow",children:(0,_.jsx)(ej.Z,{clientThreadId:a,onCompletionFinished:s,preRequestCompletion:u,hideHeader:!0,prependThreadChildren:(0,_.jsx)("div",{className:"h-8"})})}),"debug"===p&&(0,_.jsx)(ew.fv,{clientThreadId:a,slideOver:!1,onClose:()=>ek.vm.toggleActiveSidebar("debug"),isOpen:!0})]})})});function t3(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,a)}return i}function t4(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?t3(Object(i),!0).forEach(function(t){(0,h.Z)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t3(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var t5=((l=t5||{}).MAGIC_MAKER="magic",l.ADVANCED="advanced",l.PREVIEW="preview",l);function t8(e){let{value:t,label:i}=e;return(0,_.jsx)(W.ck,{value:t,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-medium text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] md:w-1/2",children:i})}function t6(e){let{className:t,editorTab:i,setEditorTab:a}=e;return(0,_.jsxs)(W.fC,{className:(0,Q.default)("flex w-full overflow-hidden rounded-xl bg-token-main-surface-secondary p-1.5 md:w-1/2",t),value:i,onValueChange:e=>{a(e)},children:[(0,_.jsx)(t8,{value:t5.MAGIC_MAKER,label:"Create"}),(0,_.jsx)(t8,{value:t5.ADVANCED,label:"Configure"}),(0,_.jsx)("div",{className:"flex w-1/3 md:hidden",children:(0,_.jsx)(t8,{value:t5.PREVIEW,label:"Preview"})})]})}let t9={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,promptStarters:[],sharing:{recipient:b.Zz.Private,subjects:[]},tools:[{type:g.qK.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},t7=t4(t4({},t9),{},{tools:[...t9.tools,{type:g.qK.BROWSER}]});function ie(e){var t,i,a,s,r,n,l;return{id:e.gizmo.id,instructions:e.gizmo.instructions,name:e.gizmo.display.name,description:null!==(t=e.gizmo.display.description)&&void 0!==t?t:"",profilePictureId:null!==(i=e.gizmo.display.profile_pic_id)&&void 0!==i?i:void 0,profilePictureUrl:null!==(a=e.gizmo.display.profile_picture_url)&&void 0!==a?a:void 0,promptStarters:null!==(s=e.gizmo.display.prompt_starters)&&void 0!==s?s:[],tools:e.tools,files:e.files,sharing:null!==(r=e.gizmo.sharing)&&void 0!==r?r:{subjects:[],recipient:e.gizmo.share_recipient},trainingDisabled:null!==(n=e.gizmo.training_disabled)&&void 0!==n&&n,sharingRecipient:e.gizmo.share_recipient,sharingTargets:e.gizmo.sharing_targets,liveVersion:null!==(l=e.gizmo.live_version)&&void 0!==l?l:0}}let it=e=>{let{gizmo:t,onNewGizmoId:i}=e,a=(0,f.C)(R.L0.BrowseAvailable),s=(0,et.Z)(),r=(0,z.useRef)(null!=t?ie(t):a?t7:t9),n=(0,z.useRef)(t),l=(0,z.useRef)(r.current),{0:o,1:c}=(0,z.useState)(()=>r.current),{0:d,1:u}=(0,z.useState)(()=>(0,D.OX)()),{0:p}=(0,z.useState)(()=>({context_message:function(e){var t,i,a;let s=new Set;for(let t of e.tools)s.add(t.type);let r=null!==(t=e.name)&&void 0!==t?t:"",n=null!==(i=e.description)&&void 0!==i?i:"",l=null!==(a=e.instructions)&&void 0!==a?a:"",o=Array.from(s).join(","),c=""===r&&""===n&&""===l,d=null!=e.profilePictureUrl;return c?"The GPT you are about to has the following abilities: ".concat(o,"."):"This is the GPT's current set of fields:\n\nname: ".concat(r,"\n\ndescription: ").concat(n,"\n\ncontext: ").concat(l,"\n\nabilities: ").concat(o,"\n\n").concat(d?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}(r.current),model_slug:"unused",enabled_tools:[{tool_id:null!=t?"gizmo_editor":"gizmo_creator"}]}));!function(e,t,i){(0,D.ax)(e,{kind:ea.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:i}),(0,z.useEffect)(()=>{D.tQ.updateConversationMode(e,{kind:ea.OL.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:i})},[e,t.id,i]);let{0:a}=(0,z.useState)(()=>{let e=null==t.id,i=null!=t.id&&""!==t.name&&null!=t.description&&""!==t.instructions&&null!=t.profilePictureUrl;return e?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':i?"Welcome back! Is there anything ".concat(t.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});(0,z.useEffect)(()=>{let t=D.tQ.getTree(e);if(t.findNode(e=>{var t;return e.message.author.role===ea.uU.User||(null===(t=e.metadata)||void 0===t?void 0:t.isClientCreatedSystemMessage)===!0})||(D.tQ.deleteNodesByFilter(e,e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.isPlaceholderTemplateAssistantWelcomeMessage)===!0}),null==a||0===a.length))return;let i=D.tQ.getThreadCurrentLeafId(e);if(!t.hasNodeOrMessageId(i))return;let s=(0,eC.Z)();D.tQ.updateTree(e,e=>{e.addNode(s,a,i,ea.uU.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),D.tQ.setThreadCurrentLeafId(e,s)},[e,a]);let s=(0,D.UL)(e);(0,z.useEffect)(()=>{(0,D.Zz)(e)&&D.iN.hasThread(e)&&s.lastModelUsed!==ef.Mw&&D.tQ.updateInitialThreadDataForNewThread(e,ef.Mw,[])},[e,s,s.lastModelUsed])}(d,l.current,p);let{data:h}=(0,m.kg)(r.current.id),x=(0,m.N_)(),{isPending:v,error:j}=x,y=(0,m.ZJ)(),w=(0,z.useMemo)(()=>{var e,t,i,a,s,r;return null!=h&&(!(o.name===h.gizmo.display.name&&o.description===h.gizmo.display.description&&o.instructions===h.gizmo.instructions&&(s=o.tools,r=h.tools,s.length===r.length&&s.every(e=>r.some(t=>t.type===e.type)))&&(0,X.isEqual)(null!==(e=null===(t=o.files)||void 0===t?void 0:t.map(e=>e.file_id))&&void 0!==e?e:[],null!==(i=null===(a=h.files)||void 0===a?void 0:a.map(e=>e.file_id))&&void 0!==i?i:[]))||o.profilePictureUrl!=h.gizmo.display.profile_picture_url||o.profilePictureId!=h.gizmo.display.profile_pic_id)},[o,h]),k=async()=>{let e=r.current;try{let t=await x.mutateAsync({editorData:e,gizmoId:e.id});if(n.current=t,null==r.current.id){let e=t.gizmo.id;r.current=t4(t4({},r.current),{},{id:e,sharingTargets:t.gizmo.sharing_targets}),c(r.current),null==i||i(e)}for(let e of t.tools.filter(e=>e.type===g.qK.JIT_PLUGIN)){let t=r.current.tools.find(t=>t.type===g.qK.JIT_PLUGIN&&t.metadata.domain===e.metadata.domain);t&&t.metadata.action_id!==e.metadata.action_id&&(t.metadata.action_id=e.metadata.action_id,c(r.current))}return t}catch(i){var t;let e=null!==(t=(0,B.Ot)(i))&&void 0!==t?t:s.formatMessage(tF.errorSavingDraft);throw L.m.warning(e,{duration:2}),i}},N=(0,z.useRef)(),P=async()=>null!=r.current.id?r.current.id:(null==N.current&&(N.current=k().then(e=>e.gizmo.id).catch(e=>{throw N.current=void 0,e})),N.current),{0:M}=(0,z.useState)(()=>(0,X.debounce)(()=>k(),2e3,{trailing:!0}));function Z(e){let t="function"==typeof e?e(r.current):(0,e5.x$)(r.current,e);(0,X.isEqual)(t,r.current)||(r.current=t,c(r.current),M())}let O=(0,z.useRef)(),S=async e=>{if(null==e){es(!1);return}try{let t=await tK(r.current,e,O.current);null!=t&&(Z(t),l.current=(0,X.cloneDeep)(r.current))}catch(e){console.error(e),L.m.warning("Something went wrong generating your GPT",{duration:3})}finally{O.current=D.tQ.getThreadCurrentLeafId(e),es(!1)}},A=function(e,t,i){D.tQ.initThread(e,{kind:ea.OL.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:i});let a=(0,eO.Z)(e,void 0,t,[]);return async(t,s,r)=>{if(0===r.length)return;let n=D.tQ.getThreadCurrentLeafId(e);for(let t of r){let i=(0,eC.Z)();D.tQ.updateTree(e,e=>{e.addNodeToEnd(n,{id:i,children:[],parentId:n,message:tW.Cv.getTextAsMessage(t,ea.uU.System),metadata:{isClientCreatedSystemMessage:!0}})}),D.tQ.setThreadCurrentLeafId(e,i),n=i}let l=n;tQ(e,l,t,s);let o={conversationMode:{kind:ea.OL.GizmoMagicCreate,gizmo_id:t.current.id,behavior_overrides:i}},c=await (0,e_.rS)(ea.OL.GizmoMagicCreate),d=await eP.ZP.getEnforcementToken(c),u=await eM.Z.getEnforcementToken(c);a({model:ef.Mw,completionType:ea.Os.Next,parentNodeId:l,metadata:{},focusOnNewCompletion:!0,arkoseToken:d,turnstileToken:u,preflightTime:0,completionMetadata:o})}}(d,S,p),{0:I,1:G}=(0,z.useState)(void 0);(0,z.useEffect)(()=>{G(function(e){var t;if(!e)return;let i=(null===(t=e.gizmo.appeal_info)||void 0===t?void 0:t.state.kind)==="appeal_sent",a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=new Set(t.filter(e=>e.allowed).map(e=>e.recipient));if(!e||i.has(e))return C.None;let a=i.has(b.Zz.Private)||i.has(b.Zz.Workspace),s=i.has(b.Zz.Link)||i.has(b.Zz.Marketplace);return e===b.Zz.Marketplace&&s?C.RemovedFromMarketplace:!s&&a?C.RemovedFromPublic:C.RemovedFromPrivate}(e.gizmo.share_recipient,e.gizmo.sharing_targets);return{sharingRecipient:e.gizmo.share_recipient,categories:e.gizmo.categories,gizmoId:e.gizmo.id,moderationType:a,sharingTargets:e.gizmo.sharing_targets,showModal:i?T.AppealSent:a!==C.None?T.AppealAvailable:T.None}}(t))},[null==t?void 0:t.gizmo.id]);let U=async(e,t)=>{let i=(0,e5.bw)(r.current,e.recipient,t);if(i.length>0){L.m.warning("Could not save GPT:\n\n".concat(i.map(e=>"- ".concat((0,e5.sw)(e))).join("\n")),{duration:3});return}let a=await k(),s=a.gizmo.id;try{return J.A.logEvent(Y.M.promoteGizmo,{gizmo_id:a.gizmo.id,sharing_recipient:e.recipient,editor_tab:F}),await y.mutateAsync({gizmoId:a.gizmo.id,data:{sharingRecipient:e.recipient,categories:null==t?void 0:[t]}},{onSuccess(e){K.E.setQueryData((0,m.Vw)(s).queryKey,e),K.E.invalidateQueries({queryKey:["gizmos"]}),K.E.invalidateQueries({queryKey:["gizmo",{gizmoId:s}]}),K.E.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:s}]})}})}catch(t){t instanceof b.DC?G({gizmoId:s,sharingRecipient:e.recipient,moderationType:C.PublishBlocked,sharingTargets:t.response.sharing_targets,showModal:T.AppealAvailable}):(console.error(t),L.m.warning("Error saving GPT",{duration:2}))}},V=x.isPending||y.isPending,{0:F,1:q}=(0,z.useState)(()=>{let e=H.m.getItem(H.F.GizmoEditorTab);return Object.values(t5).includes(e)?e:t5.MAGIC_MAKER}),{width:W}=function(){let{0:e,1:t}=(0,z.useState)({width:null,height:null});return(0,z.useLayoutEffect)(()=>{let e=()=>{t({width:window.innerWidth,height:window.innerHeight})};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}();(0,z.useEffect)(()=>{null!=W&&W>=768&&F===t5.PREVIEW&&q(t5.MAGIC_MAKER)},[W,F]);let{0:$,1:ee}=(0,z.useState)(!1),{0:ei,1:es}=(0,z.useState)(!1),{0:er,1:en}=(0,z.useState)(void 0);return(0,_.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,_.jsx)(tU,{gizmoEditorData:o,isLoading:V,hasUnpublishedChanges:w,isUploadingProfilePic:$,isGeneratingProfilePic:ei,publishedGizmo:h,promoteGizmo:async(e,t)=>{let i=await U(e,t);return r.current=t4(t4({},r.current),{},{sharingRecipient:e.recipient}),c(r.current),H.m.setItem(H.F.GizmoEditorTab,F),i},appealGizmo:async(e,t)=>{null!=I&&G(t4(t4({},I),{},{sharingRecipient:e,categories:null==t?void 0:[t],showModal:T.AppealAvailable}))},revertDraft:null!=h&&w?()=>{let e=K.E.getQueryData((0,m.Vw)(r.current.id).queryKey);if(null!=e){let t=ie(e);r.current=t,c(t),k()}}:void 0,draftMessage:(0,_.jsx)(tB,{hasUnpublishedChanges:w,isSavingDraft:v,upsertDraftError:j,className:"text-sm"}),showActionsModal:e=>{en(e)},className:"flex-shrink-0"}),I&&(0,_.jsx)(E,{appealState:I,onAppealClose:()=>G(t4(t4({},I),{},{showModal:T.None})),onAppealSubmitted:()=>G(t4(t4({},I),{},{showModal:T.AppealSent}))}),(0,_.jsxs)("div",{className:"relative flex w-full grow overflow-hidden",children:[(0,_.jsx)("div",{className:"flex w-full justify-center md:w-1/2",children:(0,_.jsx)("div",{className:"h-full grow overflow-hidden",children:void 0!==er?(0,_.jsx)(eQ,{currentlyEditingActionDomain:er,gizmoEditorData:o,updateGizmo:Z,onClose:()=>{en(void 0)}}):(0,_.jsxs)("div",{className:"flex h-full flex-col px-2 pt-2",children:[(0,_.jsx)("div",{className:"flex w-full flex-row justify-center",children:(0,_.jsx)(t6,{editorTab:F,setEditorTab:q,className:"mb-2 flex-shrink-0 self-center"})}),(0,_.jsx)("div",{className:"grow overflow-hidden",children:F===t5.MAGIC_MAKER?(0,_.jsx)("div",{className:"h-full w-full pb-5",children:(0,_.jsx)(t2,{gizmoEditorData:o,updateGizmo:Z,completionCallbackResponse:S,clientThreadId:d,gizmoEditorDataRef:r,magicMakerBehaviorOverrides:p,magicMakerConversationGizmoEditorDataRef:l,requireGizmoId:P},d)}):F===t5.ADVANCED?(0,_.jsx)(eh.cK,{gizmoEditorData:o,updateGizmo:Z,generateProfilePic:()=>{es(!0),A(r,l,["Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response."])},setIsUploadingProfilePic:ee,isGeneratingProfilePic:ei,setIsGeneratingProfilePic:es,requireGizmoId:P,onShowActionsEditor:e=>{en(e)}}):(0,_.jsx)(eL,{gizmoEditorData:o,isSavingDraft:v,showTitle:!1})})]})})}),(0,_.jsx)("div",{className:(0,Q.default)("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-main-surface-secondary pt-4",F!==t5.PREVIEW&&"md:flex"),children:(0,_.jsx)("div",{className:"flex-grow pb-5",children:(0,_.jsx)("div",{className:"h-full",children:(0,_.jsx)(eL,{gizmoEditorData:o,isSavingDraft:v})})})})]})]})};function ii(e){let{businessWorkspaceId:t,gizmoId:i}=e,{data:a}=(0,m.b9)(i,!0),s=(0,V.ec)(V.F_.accountUserId),r=(0,V.aF)(),n=null==r?void 0:r.id,l=null!=a&&null!=s&&null!=n&&(0,eb.k1)(a,s,n,t);return null!=a&&l?(0,_.jsx)(it,{gizmo:a}):null}function ia(e){let{onNewGizmoId:t}=e;return(0,_.jsx)(it,{gizmo:void 0,onNewGizmoId:t})}function is(e){let{gizmoId:t,remixSourceId:i}=e,a=(0,$.useRouter)(),s=(0,U.t)(),r=(0,V.ec)(V.F_.businessWorkspaceId),n=(0,z.useRef)(void 0),l=t;return null!=t&&n.current===t&&(l=void 0),(0,F.yx)({resetThreadAction:()=>{a.push("/")}}),(0,_.jsx)("div",{children:null!=s&&s.data?(0,_.jsx)("div",{children:void 0!=l?(0,_.jsx)(ii,{businessWorkspaceId:r,gizmoId:l},l):(0,_.jsx)(ia,{remixSourceId:i,onNewGizmoId:e=>{n.current=e,window.history.replaceState(window.history.state,"",(0,q.AA)(e))}})}):(0,_.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,_.jsx)(G.Z,{})})})}var ir=i(19892),il=!0;function io(){var e;let t=(0,U.t)();e=null==t||t.canCreateGizmos(),(0,z.useEffect)(()=>{e||ee().replace((0,ir.M5)(ir.LT.NO_ACCESS),void 0,{shallow:!0})},[e]);let i=(0,$.useRouter)(),a=i.query.slug,s=a?(0,m.CR)(a):void 0,{remixFrom:r}=i.query;return((0,z.useEffect)(()=>{(0,e_.rS)().then(e=>{eP.ZP.initializeAndGatherData(e)})},[]),(0,z.useEffect)(()=>{null==t||t.canCreateGizmos()||i.push("/")},[t,i]),null!=t&&t.canCreateGizmos())?(0,_.jsx)(is,{gizmoId:s,remixSourceId:r}):null}}}]);
//# sourceMappingURL=2422-973863910709f07f.js.map
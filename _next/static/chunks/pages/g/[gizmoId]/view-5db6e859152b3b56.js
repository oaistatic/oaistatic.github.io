(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9457],{85652:function(e,s,r){"use strict";r.r(s),r.d(s,{__N_SSP:function(){return S},default:function(){return X}});var l=r(89691),i=r(25660),t=r(28144),n=r(43383),a=r(25991),o=r(84297),c=r(8402),d=r(49508),m=r(28373),u=r(99715),x=r(61236),f=r(10518),j=r(61888),h=r(70079),p=r(68498),y=r(84692),v=r(35250);let b=e=>{let{gizmoId:s,limit:r,cursor:l}=e;return(0,x.a)({queryFn:async()=>d.U.listVersions({gizmoId:s}),queryKey:["gizmo","versions",{gizmoId:s,limit:r,cursor:l}]})},g=(0,h.memo)(function(e){let{gizmoId:s,onSelectVersion:r}=e,{value:l}=(0,f.sB)(f.tz.GizmoVersionHistory);return s&&l?(0,v.jsx)(N,{gizmoId:s,onSelectVersion:r}):null});function N(e){let{gizmoId:s,onSelectVersion:r}=e,{data:l}=b({gizmoId:s});return l?(0,v.jsx)("div",{className:"relative h-full w-screen max-w-2xs",children:(0,v.jsx)("div",{className:"flex h-full max-w-2xs flex-col overflow-y-scroll bg-token-sidebar-surface-primary py-6 shadow-xl",children:(0,v.jsx)("div",{className:"relative flex-1 px-4 sm:px-6",children:l.items&&Object.keys(l.items).map((e,s)=>(0,v.jsx)(w,{date:e,entries:l.items[e],onSelectVersion:r},s))})})}):null}function w(e){let{date:s,entries:r,onSelectVersion:l}=e;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"my-2 border-b border-token-border-medium py-2 font-medium uppercase text-token-text-secondary",children:(0,v.jsx)(p.Ji,{value:s,dateStyle:"medium"})}),(0,v.jsx)("div",{className:"flex flex-col space-y-2",children:r.map((e,s)=>(0,v.jsxs)("div",{className:"flex flex-row items-center justify-between border-b border-token-border-medium hover:cursor-pointer",onClick:()=>l(e.version),children:[(0,v.jsx)("span",{className:"p-2 hover:bg-token-sidebar-surface-tertiary",children:(0,v.jsx)(p.Ji,{value:e.updated_at,timeStyle:"short"})}),(0,v.jsx)(z,{})]},s))})]})}function z(){return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(u.fC,{children:[(0,v.jsx)(u.xz,{asChild:!0,children:(0,v.jsx)("button",{color:"neutral",className:"rounded-lg px-3 py-2 text-token-text-primary duration-100 ease-in hover:bg-token-sidebar-surface-tertiary active:scale-[0.9]",children:(0,v.jsx)(c.Yr,{className:"icon-md"})})}),(0,v.jsx)(u.Uv,{children:(0,v.jsx)(u.VY,{className:"flex min-w-[100px] max-w-xs flex-col rounded-xl border border-gray-400 bg-token-main-surface-primary shadow-lg dark:border-gray-700",sideOffset:7,children:(0,v.jsxs)(m.UA,{disabled:!1,onClick:j.noop,children:[(0,v.jsx)(c.Nt,{className:"icon-md"}),(0,v.jsx)(y.Z,{id:"gizmoVersionHistory.restoreVersionLabel",defaultMessage:"Restore this version"})]})})})]})})}var _=r(12366);let k=e=>{let{gizmoId:s,version:r}=e;return(0,x.a)({queryFn:async()=>d.U.getVersion({gizmoId:s,version:r}),queryKey:["gizmo","version",{gizmoId:s,version:r}]})};function C(e){var s;let{gizmoId:r}=e,{0:i,1:t}=(0,h.useState)(null),n=(0,_.useRouter)(),{data:a}=(0,l.b9)(r),o=null==a||null===(s=a.gizmo.current_user_permission)||void 0===s?void 0:s.can_write;return(0,v.jsxs)("div",{className:"flex h-screen w-full flex-col items-center",children:[(0,v.jsx)("div",{className:"relative flex h-16 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",children:a&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"flex items-center gap-2",children:[(0,v.jsx)("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>n.back(),children:(0,v.jsx)(c.L7,{className:"icon-lg"})}),(0,v.jsx)("div",{className:"font-medium",children:o?(0,v.jsx)(y.Z,{id:"gizmoReadOnly.versionHistoryTitle",defaultMessage:"Version History"}):(0,v.jsx)(y.Z,{id:"gizmoReadOnly.configurationTitle",defaultMessage:"Configuration"})})]}),(0,v.jsx)("div",{className:"mr-4 flex items-center gap-2",children:o?(0,v.jsx)(m.cY,{color:"light",children:"Restore this version"}):(0,v.jsx)(m.cY,{color:"light",children:"Duplicate"})})]})}),(0,v.jsxs)("div",{className:"flex h-full w-full items-center",children:[o&&(0,v.jsx)(g,{gizmoId:r,onSelectVersion:e=>{t(e)}}),(0,v.jsx)(I,{gizmoId:r,version:i})]})]})}function I(e){var s;let{gizmoId:r,version:l}=e,{data:c}=k({gizmoId:r,version:l}),{0:d,1:m}=(0,h.useState)(null);return c?(0,v.jsx)("div",{className:"flex max-h-[80vh] flex-grow justify-center overflow-y-auto",children:(0,v.jsxs)("div",{className:"flex w-full max-w-2xl flex-col text-sm",children:[(0,v.jsx)(a.hj,{className:"self-center",children:(0,v.jsx)(n.Z,{src:c.gizmo.display.profile_picture_url,isFirstParty:!1,className:"h-12 w-12"})}),(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Name"}),(0,v.jsx)(a.yt,{type:"text",value:c.gizmo.display.name,disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Description"}),(0,v.jsx)(a.yt,{type:"text",value:null!==(s=c.gizmo.display.description)&&void 0!==s?s:"",disabled:!0,className:"bg-token-main-surface-secondary"})]}),(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Instructions"}),(0,v.jsx)(a.B1,{className:"resize-none bg-token-main-surface-secondary",rows:8,value:c.gizmo.instructions,disabled:!0})]}),c.gizmo.display.prompt_starters&&c.gizmo.display.prompt_starters.length>0&&(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Conversation starters"}),c.gizmo.display.prompt_starters.map((e,s)=>(0,v.jsx)(a.yt,{type:"text",value:e,disabled:!0,className:"resize-none bg-token-main-surface-secondary"},s))]}),c.files&&c.files.length>0&&(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Knowledge"}),c.files.map((e,s)=>(0,v.jsx)(t.Z,{file:e.name,fileId:e.id},s))]}),(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Capabilities"}),(0,v.jsx)(o.W,{enabledTools:c.tools,onEnabledToolsChange:j.noop})]}),(0,v.jsxs)(a.hj,{children:[(0,v.jsx)(a.lX,{label:"Actions"}),c.tools.filter(e=>e.type===i.qK.JIT_PLUGIN).map((e,s)=>(0,v.jsx)(a.r,{isDisabled:!0,actionTool:e,onShowActionsEditor:()=>{(null==d?void 0:d.metadata.action_id)===e.metadata.action_id?m(null):m(e)}},s)),d&&(0,v.jsx)("textarea",{readOnly:!0,value:d.metadata.raw_spec,className:"block h-96 w-full border-t-0 border-token-main-surface-tertiary bg-transparent p-2 font-mono text-xs text-token-text-primary"})]})]})}):null}var V=r(24668),S=!0;function X(){var e,s;let r=(0,V.t)(),i=(0,_.useRouter)(),t=null!==(e=null===(s=i.query)||void 0===s?void 0:s.gizmoId)&&void 0!==e?e:"",n=(0,l.CR)(t),{value:a}=(0,f.sB)(f.tz.GizmoVersionHistory);return(0,h.useEffect)(()=>{null!=r&&r.isFree()&&i.push("/")},[r,i]),a?(0,v.jsx)(C,{gizmoId:n}):null}},41510:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/g/[gizmoId]/view",function(){return r(85652)}])}},function(e){e.O(0,[8697,4736,2888,9774,179],function(){return e(e.s=41510)}),_N_E=e.O()}]);
//# sourceMappingURL=view-5db6e859152b3b56.js.map